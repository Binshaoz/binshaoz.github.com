<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>十三的个人博客</title>
  
  <subtitle>我不在彩虹，彩虹在我.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://Binshao.site/"/>
  <updated>2018-09-16T14:34:27.735Z</updated>
  <id>http://Binshao.site/</id>
  
  <author>
    <name>十三</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>扎心的八月</title>
    <link href="http://Binshao.site/2018/08/30/Aug/"/>
    <id>http://Binshao.site/2018/08/30/Aug/</id>
    <published>2018-08-30T01:29:02.000Z</published>
    <updated>2018-09-16T14:34:27.735Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，人生中最后一个暑假假期就剩下两天了，余额严重不足感……  </p></blockquote><p>&emsp;&emsp;好些天没来记录了，这段时间都用来养病去了，以至于感觉过的没那么充实却又觉意义深远，今天家这边大雨倾盆，竟然有些凉意。</p><a id="more"></a><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvbq1oxu6sj30p00irwm1.jpg" alt=""></div></p><h2 id="糟糕的八月"><a href="#糟糕的八月" class="headerlink" title="糟糕的八月"></a>糟糕的八月</h2><p>&emsp;&emsp;假期这段时间以来，大多数时间就在电脑前敲代码、查阅技术书籍，记录学习过程并总结成文，就这样一天过一天，时间如流水，转眼就来到月，也不知道是哪天感觉双眼发烫，眨眼间有种胀痛感，镜子前一看双眼充红，这一下给吓得不行，赶紧找大夫去…</p><p>&emsp;&emsp;接下来这段时间自然便是与药片相伴的日子，因用眼过度导致眼疲劳，一不小心病毒就入侵了，病毒侵占成功并大肆举起红旗，颇有得意之感。双眼看起来就像杀红了眼…每隔 2 小时就得滴眼药水，这种状态一直持续了好久，还记得养病期间和老友们去影院看电影，全程都在闭着眼睛没怎么看电影，过后还被批评不走心（你看我一脸委屈脸，哭），现在想想还觉得挺好笑，哈哈！<br><br></p><h2 id="用眼指南"><a href="#用眼指南" class="headerlink" title="用眼指南"></a>用眼指南</h2><p>&emsp;&emsp;既然出了问题就要找出问题所在，我回顾了下，长期坐在电脑跟前不动这算其一，放松娱乐就是下意识拿起手机，真当身体是刀枪不入？这样子下来眼睛肯定受不了，是该学点养生知识了：  </p><ul><li>泡点菊花枸杞茶喝喝.  </li><li>使用电脑每隔 <code>四五十</code> 分钟起身走走，让眼睛眺望远处放松放松.</li><li>有意识地增加眨眼次数.</li><li>做做眼保健操.</li><li>保证充足的睡眠.</li><li>真的要加强锻炼身体.</li></ul><p>&emsp;&emsp;是不是俨然一副手拿保温杯养生老干部的样子，高手在民间，呵…</p><p>&emsp;&emsp;经过这段时间的休息，眼睛也恢复的差不多了，然而我的假期就快要结束了，没有想到会这样度过这最后一个暑假期，我想这还真是让人印象深刻阿！吃一垫，长一智！这看似糟糕的八月，却敲响了警钟，我们始终认为自己还年轻，可事实却告诉我们这是在玩火！</p><p>&emsp;&emsp;最后希望大家都有一个强壮健康的身体！<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，人生中最后一个暑假假期就剩下两天了，余额严重不足感……  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;好些天没来记录了，这段时间都用来养病去了，以至于感觉过的没那么充实却又觉意义深远，今天家这边大雨倾盆，竟然有些凉意。&lt;/p&gt;
    
    </summary>
    
      <category term="时光任意门" scheme="http://Binshao.site/categories/%E6%97%B6%E5%85%89%E4%BB%BB%E6%84%8F%E9%97%A8/"/>
    
    
      <category term="生活杂谈" scheme="http://Binshao.site/tags/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"/>
    
      <category term="健康" scheme="http://Binshao.site/tags/%E5%81%A5%E5%BA%B7/"/>
    
  </entry>
  
  <entry>
    <title>从请假流程来学习责任链模式</title>
    <link href="http://Binshao.site/2018/07/29/Responsibility/"/>
    <id>http://Binshao.site/2018/07/29/Responsibility/</id>
    <published>2018-07-29T06:45:14.000Z</published>
    <updated>2018-09-18T12:18:58.348Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，越来越感觉自身知识技能缺乏性了，真的是学的越多发现自己不懂的也就也多，稍不注意就在原地踏步，不管怎样还是要酷，Skr ~</p></blockquote><p><div align="center"><img src="http://wx1.sinaimg.cn/mw690/0060lm7Tly1fvdy3atmxyj30zk0npn23.jpg" alt=""></div></p><a id="more"></a><p><br></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;不知道大家都有请过假吗？不管是在校园还是职场上，请假似乎很常见，我们都知道请假可不是你想请就能请的，还得经过上司同意才能请假，要是请假天数太长，上司还得上报他的上司进行审批，可见这假不是想请就请的。</p><p>&emsp;&emsp;实际上，这请假流程类似于我们设计模式中的责任链模式，那么什么是责任链模式呢？今天就来学习记录一下。<br><br></p><h2 id="责任链模式-Chain-of-Responsibility"><a href="#责任链模式-Chain-of-Responsibility" class="headerlink" title="责任链模式 (Chain of Responsibility)"></a>责任链模式 (Chain of Responsibility)</h2><p>&emsp;&emsp;使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这个对象连成一条链，并沿着这条链传递该请求，直到有一个对象处理它为之。</p><p>&emsp;&emsp;那么下面我们就以请假为例演示下责任链模式的简单应用：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LeaveRequest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> leaveDays;</span><br><span class="line">    <span class="keyword">private</span> String reason;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LeaveRequest</span><span class="params">(String name, <span class="keyword">int</span> leaveDays, String reason)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.leaveDays = leaveDays;</span><br><span class="line">        <span class="keyword">this</span>.reason = reason;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getLeaveDays</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> leaveDays;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLeaveDays</span><span class="params">(<span class="keyword">int</span> leaveDays)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.leaveDays = leaveDays;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReason</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> reason;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setReason</span><span class="params">(String reason)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.reason = reason;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们定义了请假请求类，它分别有请假人姓名、天数以及理由三个字段属性，还有构造方法和对应的 get/set 方法，代码非常简单，我们继续往下看：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Leader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> String name;</span><br><span class="line">    <span class="comment">// 责任链上的后继对象</span></span><br><span class="line">    <span class="keyword">protected</span> Leader nextLeader;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Leader</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设定责任链上的后继对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setNextLeader</span><span class="params">(Leader nextLeader)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.nextLeader = nextLeader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理请求的核心业务方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(LeaveRequest request)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着我们定义了个抽象领导类，之所以是抽象类是因为公司不止一个领导，小领导没权处理的就交给上一级的领导来处理，所以这里我们定义了指定上一级领导的方法 setNextLeader，而每个领导的权力范围都不相同，就交给我们子类来做，就有了抽象方法 handleRequest。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Director</span> <span class="keyword">extends</span> <span class="title">Leader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Director</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(LeaveRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getLeaveDays() &lt; <span class="number">3</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"员工："</span> + request.getName() + <span class="string">"请假, 天数"</span> + </span><br><span class="line">        request.getLeaveDays() + <span class="string">", 请假理由："</span> + request.getReason());</span><br><span class="line">            System.out.println(<span class="string">"主任："</span> + <span class="keyword">this</span>.name + <span class="string">"，批准！"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.nextLeader != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.nextLeader.handleRequest(request);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们底层的小领导上线了，它继承了 Leader 这个抽象类并重写了抽象方法，在抽象方法里处理请假这个流程，我们可以看到，只要请假天数不超过 3 天，他有权可以审批我们请假要求，如果是超过 3 天，那他就无权处理，只能交给上一级领导来审批，那么来看看他的上一级领导：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Manager</span> <span class="keyword">extends</span> <span class="title">Leader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Manager</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(LeaveRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getLeaveDays() &lt; <span class="number">7</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"员工："</span> + request.getName() + <span class="string">"请假, 天数"</span> + </span><br><span class="line">        request.getLeaveDays() + <span class="string">", 请假理由："</span> + request.getReason());</span><br><span class="line">            System.out.println(<span class="string">"经理："</span> + <span class="keyword">this</span>.name + <span class="string">"，批准！"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.nextLeader != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.nextLeader.handleRequest(request);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们可以看到这个类与上面的类几乎是相同的，没什么区别，区别在于他能审批不超过 7 天的请假要求，否则他也只能上报上一级领导。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneraManager</span> <span class="keyword">extends</span> <span class="title">Leader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GeneraManager</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(LeaveRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getLeaveDays() &lt; <span class="number">14</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">"员工："</span> + request.getName() + <span class="string">"请假, 天数"</span> + </span><br><span class="line">        request.getLeaveDays() + <span class="string">", 请假理由："</span> + request.getReason());</span><br><span class="line">            System.out.println(<span class="string">"总经理："</span> + <span class="keyword">this</span>.name + <span class="string">"，批准！"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"员工："</span> + request.getName() + <span class="string">"请假, 天数"</span> + </span><br><span class="line">                    request.getLeaveDays() + <span class="string">", 请假理由："</span> + request.getReason());</span><br><span class="line">            System.out.println(<span class="string">"总经理：没钱哪都去不了，给我好好写代码去！"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后一级大 Boss…下面立即开始我们的请假流程：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Leader director = <span class="keyword">new</span> Director(<span class="string">"张三"</span>);</span><br><span class="line">        Leader manager = <span class="keyword">new</span> Manager(<span class="string">"李四"</span>);</span><br><span class="line">        Leader generaManager = <span class="keyword">new</span> GeneraManager(<span class="string">"王五"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 组织责任链关系</span></span><br><span class="line">        director.setNextLeader(manager);</span><br><span class="line">        manager.setNextLeader(generaManager);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始请假</span></span><br><span class="line">        LeaveRequest request = <span class="keyword">new</span> LeaveRequest(<span class="string">"十三"</span>, <span class="number">14</span>, <span class="string">"世界那么大，我想去看看..."</span>);</span><br><span class="line">        director.handleRequest(request);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 运行结果：</span><br><span class="line">员工：十三请假, 天数14, 请假理由：世界那么大，我想去看看...</span><br><span class="line">总经理：没钱哪都去不了，给我好好写代码去！</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们先把相关领导类实例化后再指定责任链关系，然后我们再进行请求，这样我们请求的客户端并不知道是哪一个对象处理这个请求，但是我们能得到相关的处理结果，这样系统的更改可以在不影响客户端的情况下动态分配责任。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;最后我们来简单总结下。</p><p>&emsp;&emsp;责任链模式中最关键的是客户提交请求时，请求是沿着链进行传递直到有一个具体处理对象负责处理它，这样一来，请求者不需要关心是哪个处理对象在处理，我只要等请求被处理即可。责任链还简化了对象之间的连接，它们只需要<code>保持一个指向其后继者的引用，</code>这和数据结构的链表是非常相似的，无需保持后继者的引用，这就大大<code>降低耦合度。</code>不仅如此，我们可以<code>随时随地增加或修改请求的结构，</code>当然了，假如我们没有正确配置责任链，可能请求到了链尾都没有被处理。</p><p>常见场景：</p><ul><li><p>Java 中的异常机制就是一种责任链模式，一个 try 可以对应多个 catch，当一个 catch 不匹配类型，则自动跳转到下一个 catch.</p></li><li><p>JS 中事件的冒泡和捕获机制.</p></li></ul><p><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，越来越感觉自身知识技能缺乏性了，真的是学的越多发现自己不懂的也就也多，稍不注意就在原地踏步，不管怎样还是要酷，Skr ~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx1.sinaimg.cn/mw690/0060lm7Tly1fvdy3atmxyj30zk0npn23.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="责任链模式" scheme="http://Binshao.site/tags/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>程序猿相亲记</title>
    <link href="http://Binshao.site/2018/07/27/Mediator/"/>
    <id>http://Binshao.site/2018/07/27/Mediator/</id>
    <published>2018-07-27T06:44:43.000Z</published>
    <updated>2018-09-18T12:16:20.884Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，最近又把使命召唤的现代战争系列重看了一遍，剧情是真的赞，个人认为使命召唤 4、6、8 这三部曲实在是经典阿，还有荣誉勋章这款游戏也不错，青春阿……    </p></blockquote><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdxr768qqj30zk0nsn74.jpg" alt=""></div></p><a id="more"></a><p><br></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;不知道有小伙伴是否也是枪械迷，推荐大家去 B 站搜索 Up 主哲学的石头，他的打法真的一路凶残到底，枪法意识都很好，看了他的视频再去看其他视频，感觉其他 Up 主的视频都没劲，当然对我而言是这样的，太厉害了。</p><p>&emsp;&emsp;好了，题外话就说到这里了，今天咱们继续来学习中介者设计模式，说到中介者十三第一个想到就是房产中介了，可是老是提房也是烦，主要是穷的一笔……好，那咱就换个婚姻中介，卧槽……你这真的是猝不及防。当然了，也不是什么都一上来就是找中介什么的，什么都得自己先试试。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> condition;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.condition = condition;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> condition;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCondition</span><span class="params">(<span class="keyword">int</span> condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.condition = condition;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person person)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们定义了个抽象 Person 类，它有字段属性及构造方法，还提供了个抽象的找对象方法…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Man</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Man</span><span class="params">(String name, <span class="keyword">int</span> condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, condition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (person <span class="keyword">instanceof</span> Man) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Sorry,我不是Gay.."</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.getCondition() == person.getCondition()) &#123;</span><br><span class="line">                System.out.println(<span class="keyword">this</span>.getName() + <span class="string">"和"</span> + person.getName() + <span class="string">"般配"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="keyword">this</span>.getName() + <span class="string">"和"</span> + person.getName() + <span class="string">"无缘"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着这个 Man 类继承自 Person 类，它实现了 Person 类里的抽象方法，在这个抽象方法里首先判断传入的 person 参数是否是 Man 实例，因为总不可能两个大老爷们在一起吧，当然你喜欢吧…接着再往下判断两人之间是否条件相等，这就好比于对方是不是对你有好感，考虑你条件够不够好等等，太复杂了这个，就不多说了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Woman</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Woman</span><span class="params">(String name, <span class="keyword">int</span> condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, condition);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (person <span class="keyword">instanceof</span> Woman) &#123;</span><br><span class="line">            System.out.println(<span class="string">"Sorry,我不是Gay.."</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.getCondition() == person.getCondition()) &#123;</span><br><span class="line">                System.out.println(<span class="keyword">this</span>.getName() + <span class="string">"和"</span> + person.getName() + <span class="string">"般配"</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="keyword">this</span>.getName() + <span class="string">"和"</span> + person.getName() + <span class="string">"无缘"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;既然有 Man 类，那肯定就有 Woman 类了，这里和上面是一样的，就不再多介绍了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person shisan = <span class="keyword">new</span> Man(<span class="string">"十三"</span>, <span class="number">9</span>);</span><br><span class="line">        Person p = <span class="keyword">new</span> Man(<span class="string">"路人乙"</span>, <span class="number">10</span>);</span><br><span class="line">        Person ll = <span class="keyword">new</span> Woman(<span class="string">"LL"</span>, <span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">        shisan.getPartner(ll);</span><br><span class="line">        p.getPartner(ll);</span><br><span class="line">        p.getPartner(shisan);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 运行结果：</span><br><span class="line">十三和LL般配</span><br><span class="line">路人乙和LL无缘</span><br><span class="line">Sorry,我不是Gay..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;好了，通过结果我们可以看到十三真幸运，他和 LL 牵手成功，而路人乙则悲催了点，但是不论结果是怎样，它们互相之间是认识的，这就要求对象之间需要其他对象，好比于十三如果不认识 LL 他最后怎么可能牵手成功呢。</p><p>&emsp;&emsp;站在我们开发中来讲，类与类之间的联系就比较紧密，对象之间的相互连接降低其可复用性，可能会使得一个对象在没有其他对象的支持下而罢工。迪米特原则中提到：如果两个类不必互相通信，那么这两个类就不应该发生直接的相互作用。好，那我们应该要怎么来做呢？<br><br></p><h2 id="中介者模式-Mediator"><a href="#中介者模式-Mediator" class="headerlink" title="中介者模式 (Mediator)"></a>中介者模式 (Mediator)</h2><p>&emsp;&emsp;中介者模式是行为模式之一，用一个中介对象来封装一系列的对象交互，中介者使各对象不需要显示地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p><p>&emsp;&emsp;那么许多像路人乙那样被狠心拒绝，或者平时没有什么机会接触异性，那怎么办呢？于是，可能看到这个商机，各种婚姻中介强势崛起。通过这些中介对象，每个具体对象就不再同其他对象打交道了，而是通过这些中介者对象与另外一个对象发生相互作用。那么我们在上面例子的基础上再改写：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Person2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> condition;</span><br><span class="line">    <span class="keyword">private</span> Mediator mediator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person2</span><span class="params">(String name, <span class="keyword">int</span> condition, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.condition = condition;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mediator <span class="title">getMediator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> mediator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMediator</span><span class="params">(Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCondition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> condition;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCondition</span><span class="params">(<span class="keyword">int</span> condition)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.condition = condition;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person2 person)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们这个抽象 Person 类，它增加对中介者 Mediator 的应用。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Man2</span> <span class="keyword">extends</span> <span class="title">Person2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Man2</span><span class="params">(String name, <span class="keyword">int</span> condition, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, condition, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person2 person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getMediator().setMan(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">this</span>.getMediator().getPartner(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Woman2</span> <span class="keyword">extends</span> <span class="title">Person2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Woman2</span><span class="params">(String name, <span class="keyword">int</span> condition, Mediator mediator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, condition, mediator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person2 person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getMediator().setWoman(<span class="keyword">this</span>); </span><br><span class="line">        <span class="keyword">this</span>.getMediator().getPartner(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里就相当于两个具体的 Person 类，分别实现了抽象找对象方法，但是这里找对象可是通过中介介绍找的对象，这个过程我们可以这样理解，因为抽象父类 Person 持有中介者 Mediator 类的引用，所以我们这里的 getPartner 找对象方法，先是通过父类找到当前这个中介，然后注册相关会员信息，注册好后中介就会帮我们找对象了，当我们调用找对象的方法，实际上是中介者帮我们找的对象，那么下面我来看看这个中介者类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Mediator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Man2 man;</span><br><span class="line">    <span class="keyword">private</span> Woman2 woman;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMan</span><span class="params">(Man2 man)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.man = man;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWoman</span><span class="params">(Woman2 woman)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.woman = woman;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getPartner</span><span class="params">(Person2 person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (person <span class="keyword">instanceof</span> Man2) &#123;</span><br><span class="line">            <span class="keyword">this</span>.setMan((Man2) person);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.setWoman((Woman2) person);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (man.getCondition() == woman.getCondition()) &#123;</span><br><span class="line">            System.out.println(man.getName() + <span class="string">"和"</span> + woman.getName() + <span class="string">"般配"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(man.getName() + <span class="string">"和"</span> + woman.getName() + <span class="string">"无缘"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们可以看到这个中介者类它持有对具体对象的引用，这个很好理解，就相当于你要我帮你找对象，你得要把你相关信息告诉我，我好给你找对吧。再之后中介就会帮我们筛选出合适的对象，就会通知我们出来见个面？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Mediator mediator = <span class="keyword">new</span> Mediator();</span><br><span class="line"></span><br><span class="line">        Person2 man = <span class="keyword">new</span> Man2(<span class="string">"路人乙"</span>, <span class="number">3</span>, mediator);</span><br><span class="line">        Person2 woMan = <span class="keyword">new</span> Woman2(<span class="string">"小芳"</span>, <span class="number">3</span>, mediator);</span><br><span class="line">        man.getPartner(woMan);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//运行结果：</span><br><span class="line">路人乙和小芳般配</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样，路人乙就通过中介找到他的真爱，祝福他们。我们回过头来看下，相比于我们第一次的写法，路人乙和小芳它们本来之间就是不认识的，就类似于两个人类之间可以不用进行通信。但是它们都通过中介认识接触到对方，这样的话，我们的类与类之间就不需要知道其他对象了，只需要和中介者打交道就可以了。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;最后我们来简单总结下。</p><p>&emsp;&emsp;中介者的出现减少了各个类之间的耦合，明确类之间的相互关系；中介者模式将原来相互依存的多对多的类关系简化为中介者类与其他关联类一对多的关系，当其中一个类修改时也不影响其他关联类。</p><p>&emsp;&emsp;后来，据路人乙说其实那天下午他去和中介介绍的女孩见面了，等他到场时才发现对方是个男的？一问才知道，对方也是被安排出来见面的，只是没想对方竟然是个男的，没过多一会儿，原来是中介搞错了……因为生意太过于火爆，这将使得中介者会变得相当复杂繁忙。</p><p>这都不是重点，重点是路人乙发现对方竟然也是程序员，哈哈，这下可好，两人一见如故，那天他们整整聊了一下午的技术，走时，他们还互相交换了微信……<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，最近又把使命召唤的现代战争系列重看了一遍，剧情是真的赞，个人认为使命召唤 4、6、8 这三部曲实在是经典阿，还有荣誉勋章这款游戏也不错，青春阿……    &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdxr768qqj30zk0nsn74.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="中介者模式" scheme="http://Binshao.site/tags/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之适配器模式</title>
    <link href="http://Binshao.site/2018/07/25/Adapter/"/>
    <id>http://Binshao.site/2018/07/25/Adapter/</id>
    <published>2018-07-25T06:44:21.000Z</published>
    <updated>2018-09-18T12:19:06.721Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，也许是我昨天求雨的诚意感动了老天还是受台风气压影响，还真是下了场雨舒服阿，哈哈…</p></blockquote><p><div align="center"><img src="http://wx1.sinaimg.cn/mw690/0060lm7Tly1fvdxjrebkzj30zk0nqal3.jpg" alt=""></div></p><a id="more"></a>    <p><br></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;不知道大家在日常生活中有没有发现，凡是需要用电的电子产品它总得要插头充电（废话），而有些电子产品如手机、笔记本电脑等，它们不是直接插上电源就完事，电源还得经过电源适配器转换为稳定的电压才能进行充电，我们都知道每个国家地区的电压标准都是不一样的，所以要能正常充电就得需要电源适配器为我们工作，那么我们先用代码演示下没有电源适配器的情况：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 电压</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Voltage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">voltage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"当前电压：220V.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;咱天朝的家庭电压标准是 220 V。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Voltage current = <span class="keyword">new</span> Voltage();</span><br><span class="line">        current.voltage();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 运行结果：</span><br><span class="line">当前电压：220V..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;在我们就没有电源适配器的情况下，要是我们直接插上电源，恐怕笔记本要炸…</p><p>&emsp;&emsp;事实上这个场景和设计模式中的适配器模式相似，那下面我们就来一起看看适配器模式相关的介绍。<br><br></p><h2 id="适配器模式-Adapter"><a href="#适配器模式-Adapter" class="headerlink" title="适配器模式 (Adapter)"></a>适配器模式 (Adapter)</h2><p>&emsp;&emsp;适配者模式是构造型模式之一，通过 Adapter 模式可以改变已有类（或外部类)的接口形式。也就是说将一个类的接口转换成客户希望的另外一个接口。Adapter 模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。</p><p>桥接模式中的角色及职责 ：</p><ul><li><p>Target ：目标接口，客户所期待的接口，目标可以是具体的或抽象的类，也可以是接口.</p></li><li><p>Adaptee : 需要适配的类或适配者类.</p></li><li><p>Adapter : 通过包装一个需要适配的对象，把原接口转换成目标接口.</p></li></ul><p>&emsp;&emsp;好，说到这里，那么我们来看看怎么使用适配器模式，废话不多说，给我放码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过类继承实现 Adapter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adapter</span> <span class="keyword">extends</span> <span class="title">Voltage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">adapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.voltage();</span><br><span class="line">        System.out.println(<span class="string">"使用电源适配器中：20V.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们先定义个适配器类，它通过继承之前的电压类得到当前电压伏特，然后提供了个适配方法，将电压降到 20 伏特，其实这个过程相当于我们把插头插进插座里，这样就有了电流输入，接着连接到适配器中，降低当前电压电流以达到电源适配的效果，这样我们就能充电了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Adapter adapter = <span class="keyword">new</span> Adapter();</span><br><span class="line">        adapter.adapter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//运行结果：</span><br><span class="line">当前电压：220V..</span><br><span class="line">使用电源适配器中：20V..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;通过结果我们可以看到，的确使用电源适配器可以起到适配的效果。事实上，我们上面的这种写法是通过类继承来实现适配器的，我们也还可以通过另外一种方式来实现，与类继承有相似效果莫过于是组合了，没错，我们可以通过组合的方式实现适配器。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过组合实现 Adapter</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Adapter2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Voltage voltage;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Adapter2</span><span class="params">(Voltage voltage)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.voltage = voltage;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">adapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        voltage.voltage();</span><br><span class="line">        System.out.println(<span class="string">"使用电源适配器中：20V.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;它持有对电压类的引用，先在构造器中传入电压类对象参数，以便我们得到当前电压信息，再提供适配的方法，同样也能实现适配的效果。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Adapter2 adapter = <span class="keyword">new</span> Adapter2(<span class="keyword">new</span> Voltage());</span><br><span class="line">        adapter.adapter();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//运行结果：</span><br><span class="line">当前电压：220V..</span><br><span class="line">使用电源适配器中：20V..</span><br></pre></td></tr></table></figure><p><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;当系统的数据和行为都正确时，但接口不兼容，我们应该考虑使用适配器，使得对象与接口能够匹配并一起工作，适配器模式主要应用于希望复用一些现存的类，但是接口又与复用环境不一致的情况。</p><p><code>应用场景 :</code></p><ul><li><p>双方不太容易修改的时候再使用适配器模式.</p></li><li><p>旧系统改造和升级.</p></li><li><p>Java I/O 流.</p></li></ul><p>&emsp;&emsp;最后，适配器模式不能滥用，因为适配器模式只有在无法改变原有的设计和代码的情况下，才去考虑适配，假如一开始设计我们问题考虑全面，那么不匹配的问题就不会发生，我们也就不需要考虑适配了。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，也许是我昨天求雨的诚意感动了老天还是受台风气压影响，还真是下了场雨舒服阿，哈哈…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx1.sinaimg.cn/mw690/0060lm7Tly1fvdxjrebkzj30zk0nqal3.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="适配器模式" scheme="http://Binshao.site/tags/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>秋名山车王 —AE86— 改装记</title>
    <link href="http://Binshao.site/2018/07/24/Bridge/"/>
    <id>http://Binshao.site/2018/07/24/Bridge/</id>
    <published>2018-07-24T06:44:04.000Z</published>
    <updated>2018-09-18T12:19:36.113Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，新的一周依旧热的要把人融化，还是喜欢秋天，可惜在广东是没有秋天……</p></blockquote><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdx5ogl7dj30zk0npae0.jpg" alt=""></div></p><a id="more"></a><p><br></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;不知道大家喜欢看《头文字D》吗？十三我就喜欢看，特别是 86 在一次车赛中抛锚瘫痪后，拓海他老爸整了个核爆引擎，给 86 安装后简直是爆炸性输出，活脱脱一头野兽。那么今天我们也来体验一把改装的乐趣。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们定义了个 Car 接口，里面有个安装引擎的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AE86</span> <span class="keyword">implements</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着这里是个 86 的抽象类，它实现 Car 接口里的方法，它之所以是抽象类是因为我们可以给 86 进行不同的改装，而这些改装则交给它子类去完成，那么下面我们就看看它具体的子类 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">V8</span> <span class="keyword">extends</span> <span class="title">AE86</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"安装V8涡轮引擎.. "</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">V10</span> <span class="keyword">extends</span> <span class="title">Bus</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"安装V10核弹引擎.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里两个类分别对应是两种引擎，它实现了抽象类里的抽象方法，代码非常简单就不再多说了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 子类太多</span></span><br><span class="line">        AE86 car = <span class="keyword">new</span> V8();</span><br><span class="line">        car.installEngine();</span><br><span class="line"></span><br><span class="line">        AE86 Pandacar = <span class="keyword">new</span> V10();</span><br><span class="line">        Pandacar.installEngine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//输出结果：</span><br><span class="line">AE86安装V8涡轮引擎..</span><br><span class="line">AE86安装V10核弹引擎..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样的话，我们想要给 86 装上什么引擎就去实例化对应的引擎类，再调用安装方法就可以了，可是这样子的话，那我们编写的类就太多了，给人感觉非常庞杂。你看，假如我们不止要给 86 改装，还要给其他车子改装，那么不同车子引擎规格也不同，那么我们就要重新编写相关类，这样下来还不得死人？那还有没有其他的写法呢。<br><br></p><h2 id="第二版"><a href="#第二版" class="headerlink" title="第二版"></a>第二版</h2><p>&emsp;&emsp;天无绝人之路，想了许久，十三终于想出另外一种写法，我们一起来看看：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span>    <span class="function"><span class="keyword">void</span> <span class="title">installV8Engine</span><span class="params">()</span></span>;</span><br><span class="line"><span class="number">4</span>    <span class="function"><span class="keyword">void</span> <span class="title">installV10Engine</span><span class="params">()</span></span>;</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先定义了个 Car 接口，相比于之前的 Car 接口，我们这里接口直接就是不同规格的引擎方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AE86</span> <span class="keyword">implements</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installV8Engine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86安装V8涡轮引擎.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installV10Engine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86安装V10核弹引擎.."</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 要修改原有方法，不符原则</span></span><br><span class="line">        AE86 car = <span class="keyword">new</span> AE86();</span><br><span class="line">        car.installV8Engine();</span><br><span class="line"></span><br><span class="line">        AE86 Pandacar = <span class="keyword">new</span> AE86();</span><br><span class="line">        Pandacar.installV10Engine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//运行结果：</span><br><span class="line">AE86安装V8涡轮引擎..</span><br><span class="line">AE86安装V10核弹引擎..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;同样这样子我们也可以完成对 86 的改装，而且的确比之前的写法少写了不少，但是我们回过头来看，假如这时候又有其他最强的引擎，我们想要给 86 装上，那么就要在接口里再加上安装最新引擎的方法，这样子一来，就要修改到原来的代码结构，不符合我们的开放-封闭原则。看来得要放大招。<br><br></p><h2 id="桥接模式-Bridge"><a href="#桥接模式-Bridge" class="headerlink" title="桥接模式 (Bridge)"></a>桥接模式 (Bridge)</h2><p>&emsp;&emsp;桥接模式，是构造型的设计模式之一。桥接模式基于类的最小设计原则，通过使用封装、聚合以及继承等行为来让不同的类承担不同的责任。它的主要特点是把抽象（abstraction) 与行为实现 (implementation) 分离开来，从而可以保持各部分的独立性以及应对它们的功能扩展。</p><p>&emsp;&emsp;那么什么叫抽象与它的行为实现分离，<code>注意，这里不是抽象类与派生类分离，实现指的是抽象类和它的派生类用来实现自己的对象。</code></p><p>桥接模式中的角色及职责 ：</p><ul><li><p>Abstraction ：抽象类接口（接口或抽象类），维护对行为实现（Implementor）的引用.</p></li><li><p>Refined Abstraction : Abstraction 子类.</p></li><li><p>Implementor : 行为实现类接口（Abstraction 接口定义了基于 Implementor 接口的更高层次的操作）.</p></li><li><p>ConcreteImplementor : Implementor 子类.</p></li></ul><p>&emsp;&emsp;好，理论说了一大堆，究竟这个桥接模式要怎么使用呢？我们下面同样就以上面的例子演示下桥接模式的简单使用，废话不多说，放码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Implementor 类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Engine</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先出场的是我们 Implementor 类，接口里定义了安装引擎的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ConcreteImplementor 类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">V8Engine</span> <span class="keyword">implements</span> <span class="title">Engine</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86安装V8涡轮引擎.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">V10Engine</span> <span class="keyword">implements</span> <span class="title">Engine</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86安装V10核弹引擎.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;然后是两个 ConcreteImplementor 类，分别重写接口里的接口方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Engine engine;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Engine <span class="title">getEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> engine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEngine</span><span class="params">(Engine engine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.engine = engine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">(Engine engine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.engine = engine;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着我们看到这个抽象类，它持有对 Engine 类的引用，也就是维护对行为实现 Implementor 的引用，毫无疑问它是 Abstraction 类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AE86</span> <span class="keyword">extends</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AE86</span><span class="params">(Engine engine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(engine);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">installEngine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getEngine().installEngine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后我们 86 类出现了，它继承自 Abstraction 类，知道它是 Refined Abstraction 类角色，默认有个构造方法，传入的是 Engine 类型参数，也就是我们要给 86 改装什么样的引擎，再调用 installEngine 这个方法，由于父类 Abstraction 持有 Implementor 类的引用，所以最终调用的是具体的 ConcreteImplementor 类的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Engine v8 = <span class="keyword">new</span> V8Engine();     </span><br><span class="line">        Car car = <span class="keyword">new</span> AE86(v8);</span><br><span class="line">        car.installEngine();</span><br><span class="line"></span><br><span class="line">        Engine v10 = <span class="keyword">new</span> V10Engine();        </span><br><span class="line">        Car pandaCar = <span class="keyword">new</span> AE86(v10);</span><br><span class="line">        pandaCar.installEngine();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 运行结果：</span><br><span class="line">AE86安装V8涡轮引擎..</span><br><span class="line">AE86安装V10核弹引擎..</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样的设计显然不会修改原来的代码，假如有其他需求我们只用扩展类就行了，相比于之前的写法更灵活，扩展性更好。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;<code>优先使用对象合成/聚合，而不是类继承。</code>对象的继承关系是在编译时就定义好了，所以无法在运行时改变从父类继承的实现。子类的实现与它的父类有非常紧密的依赖关系，以至于父类实现中的任何变化必然会导致子类发生变化。当你需要复用子类时，如果继承下来的实现不适合解决新的问题，则父类必须重写或被其他更适合的类替换。这种依赖关系限制了灵活性并最终限制了复用性。</p><p><code>应用场景 :</code></p><ul><li><p>不希望或不适用使用继承的场景.</p></li><li><p>重用性要求较高的场景.</p></li></ul><p><code>优点 ：</code></p><ol><li><p>抽象和实现分离.</p></li><li><p>优秀的扩充能力.</p></li><li><p>客户不用关心细节的实现，它已经由抽象层通过聚合关系完成了封装.</p></li></ol><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdxgtrsc1j30mv08vt9k.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Bridge 结构图</div></p><p>&emsp;&emsp;桥接模式的意图还是对变化的封装，尽量把可能变化的因素封装起来，因此在我们开发中，发现类的继承过多时，可以考虑桥接模式。</p><p>今天的学习记录就到这里了，放松放松下，去看个电影了。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，新的一周依旧热的要把人融化，还是喜欢秋天，可惜在广东是没有秋天……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdx5ogl7dj30zk0npae0.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="桥接模式" scheme="http://Binshao.site/tags/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之组合模式</title>
    <link href="http://Binshao.site/2018/07/23/Composite/"/>
    <id>http://Binshao.site/2018/07/23/Composite/</id>
    <published>2018-07-23T07:43:30.000Z</published>
    <updated>2018-09-18T11:27:56.890Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，今日是 二十四 节气中的大暑，要是此时此刻下一场大雨就好了，而我在屋里喝茶看书，好生快活。</p></blockquote><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdwv3mtzcj30zk0npdmy.jpg" alt=""><br><br></div></p><a id="more"></a><p><br></p><h2 id="组合模式-Composite"><a href="#组合模式-Composite" class="headerlink" title="组合模式 (Composite)"></a>组合模式 (Composite)</h2><p>&emsp;&emsp;想不出有什么好的小故事作为开头，我想我需要放纵，但是想了下，咱还是继续学习设计模式吧……</p><p><code>定义：将对象组合成树形结构以表示“部分-整体“的层次结构。组合模式使得用户对单个对象和组合对象的使用具有一致性.</code></p><p>组合模式中的角色及职责 ：</p><ul><li><p>Component (树形结构的节点抽象) ：定义了叶子和容器构件的共同点.</p></li><li><p>Leaf (树形结构的叶子节点) : 无子节点.</p></li><li><p>Composite (树形结构的枝节点) : 有容器特征，可以包含子节点.</p></li></ul><p>&emsp;&emsp;好，说了那么多，究竟这个组合模式要怎么使用呢？我们下面就以杀毒软件杀毒的过程作为例子，演示下组合模式的简单使用，废话不多说，放码 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 抽象节点</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AbstrastFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">killVirus</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先定义个抽象节点接口，接口里提供了杀毒方法，它定义所有类对象共同的接口。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 容器组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Folder</span> <span class="keyword">implements</span> <span class="title">AbstrastFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> List&lt;AbstrastFile&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Folder</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(AbstrastFile file)</span> </span>&#123;</span><br><span class="line">        list.add(file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(AbstrastFile file)</span> </span>&#123;</span><br><span class="line">        list.remove(file);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killVirus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"文件夹："</span> + name + <span class="string">",查杀ing..."</span>);</span><br><span class="line">        <span class="keyword">for</span> (AbstrastFile file : list) &#123;</span><br><span class="line">            file.killVirus();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;然后是 Composite 类，可以定义枝节点和子节点的行为，它用容器集合用来存储其下属的枝节点和叶节点，这就好比于在我们电脑里的硬盘下有个文件夹，这个文件夹相当于 Composite 类，而文件夹里还可以有文件夹或者文件，文件夹里的文件夹相当于枝节点，所以我们在这个 Folder 类中分别提供了 add 和 remove 方法用来添加文件夹或文件，在重写的方法里对它的下级进行遍历，这样就可以一层层找到所有的节点。文件则是叶节点，叶节点里可就没有子节点了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageFile</span> <span class="keyword">implements</span> <span class="title">AbstrastFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">private</span> String name;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">ImageFile</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">         <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killVirus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"---图像文件:"</span> + name + <span class="string">", 查杀ing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TextFile</span> <span class="keyword">implements</span> <span class="title">AbstrastFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TextFile</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killVirus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"---文本文件:"</span> + name + <span class="string">", 查杀ing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoFile</span> <span class="keyword">implements</span> <span class="title">AbstrastFile</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">VideoFile</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">killVirus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"---视频文件:"</span> + name + <span class="string">", 查杀ing..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着在这里我们定义了三个叶节点类，分别实现抽象节点的方法。现在我们的电脑里有个“我的下载”这个文件夹，这个文件夹里有一个“下载的视频”文件夹和其他一些文件，那么我们现在要对它杀毒，来看看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        AbstrastFile imageFile, videoFile, textFile;</span><br><span class="line">        Folder folder = <span class="keyword">new</span> Folder(<span class="string">"我的下载"</span>);</span><br><span class="line"></span><br><span class="line">        imageFile = <span class="keyword">new</span> ImageFile(<span class="string">"高圆圆.jpg"</span>);</span><br><span class="line">        textFile = <span class="keyword">new</span> TextFile(<span class="string">"MainActivity.java"</span>);</span><br><span class="line"></span><br><span class="line">        Folder videoFolder = <span class="keyword">new</span> Folder(<span class="string">"下载的视频"</span>);</span><br><span class="line">        videoFile = <span class="keyword">new</span> VideoFile(<span class="string">"倚天屠龙记"</span>);</span><br><span class="line">        videoFolder.add(videoFile);</span><br><span class="line"></span><br><span class="line">        folder.add(videoFolder);</span><br><span class="line">        folder.killVirus();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">文件夹：我的下载,查杀ing...</span><br><span class="line">---图像文件:高圆圆.jpg, 查杀ing...</span><br><span class="line">---文本文件:MainActivity.java, 查杀ing...</span><br><span class="line">文件夹：下载的视频,查杀ing...</span><br><span class="line">---视频文件:倚天屠龙记, 查杀ing...</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样我们使用组合模式完成对这个文件夹进行杀毒的过程，我们来再看下组合模式工作流程 ：</p><ol><li><p>组合模式为处理树形结构提供完美的解决方案，描述了如何将容器和叶子进行递归组合，使得用户在使用时可以一致性的对待容器和叶子.</p></li><li><p>当容器对象的指定方法被调用时，将遍历整个树形结构，寻找也包含这个方法的成员，并调用执行，其中，使用了递归调用的机制对整个结构进行了处理.<br><br></p></li></ol><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;最后来简单总结下 ：</p><p><code>应用场景 :</code></p><ul><li><p>需求中体现部分与整体层次的结构时，希望用户可以忽略组合对象与单个对象的不同，统一地使用组合结构中所有对象，应该考虑使用组合模式.</p></li><li><p>操作系统的资源管理器.</p></li><li><p>GUI 中容器层次图.</p></li><li><p>XML 文件解析.</p></li><li><p>Junit 单元测试框架.</p></li></ul><p><code>优点 ：</code></p><ul><li><p>基本对象可以被组合成更复杂的组合对象，而这个组合对象又可以被组合.</p></li><li><p>用户不需关心是叶节点还是组合组件，可以一致地使用组合结构或者单个对象.</p></li></ul><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdx2s4bf2j30jo09mq3h.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Facade 结构图</div></p><p><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，今日是 二十四 节气中的大暑，要是此时此刻下一场大雨就好了，而我在屋里喝茶看书，好生快活。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdwv3mtzcj30zk0npdmy.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="组合模式" scheme="http://Binshao.site/tags/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>从造人的角度来学习外观模式</title>
    <link href="http://Binshao.site/2018/07/22/Facade/"/>
    <id>http://Binshao.site/2018/07/22/Facade/</id>
    <published>2018-07-22T06:42:57.000Z</published>
    <updated>2018-09-18T11:20:46.625Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，今天我们来讲讲如何造人，哦不……还是设计模式的学习，继续搬砖！</p></blockquote><a id="more"></a><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdwgiezpnj30zk0npgti.jpg" alt=""><br><br></div></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;不知道大家还记得小学有篇文章《女娲造人》吗？现在的课本还有没有我就不清楚了，对这篇文章印象挺深刻的，在古代人们的科学技术没有现在那么先进，对于一些事情无法做出科学合理的解释，所以古人只能凭借自己狭隘的生活体验加以想象和幻想。</p><p>&emsp;&emsp;话说女娲某天见大地了无生机，遂产生造个与自己一样的生物，先是在河边捉起一把黄泥，和点水，揉成一团，再捏个头，插上四肢，做好后女娲向泥人吹了口气，一放到地上，泥人便有了生命，它会走会说会唱，女娲非常高兴给它取了个名字叫做人…</p><p>&emsp;&emsp;于是女娲便开始疯狂造人，还别说，工作量也是挺大的。那么今天我们也来造人，试试用代码造人……瞬间掉了一个档次有木有</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Head</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"捏个头"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Body</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeBody</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"揉成身体"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Limb</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeLimb</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"插上四肢"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们分别创建了 三 个类，对应是头、身体和四肢，每个类中分别有对应的制造人体的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         <span class="comment">// 耦合性太高</span></span><br><span class="line">         Head head = <span class="keyword">new</span> Head();</span><br><span class="line">         head.makeHead();</span><br><span class="line">         Body body = <span class="keyword">new</span> Body();</span><br><span class="line">         body.makeBody();</span><br><span class="line">         Limb limb = <span class="keyword">new</span> Limb();</span><br><span class="line">        limb.makeLimb();</span><br><span class="line"></span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">捏个头</span><br><span class="line">揉成身体</span><br><span class="line">插上四肢</span><br><span class="line">成人形了...</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;通常情况下，我们都会这样来编写代码，可这样来看我们的客户端就得要和 三 个类打交道，假若我们这里不止 三 个类那这样耦合性太高了，且不符合迪米特法则，这里就可以用到外观模式。<br><br></p><h2 id="外观模式-Facade"><a href="#外观模式-Facade" class="headerlink" title="外观模式 (Facade)"></a>外观模式 (Facade)</h2><p>&emsp;&emsp;外观模式又被称为门面模式，它通过一个外观类使得整个系统的结构只有一个统一的高层接口，这样能降低用户的使用成本。</p><p><code>定义：为子系统中的一组接口提供一个一致的界面，此模式定义了一个高层接口，这个接口使得这一子系统更加容易使用.</code></p><p>代理模式中的角色及职责 ：</p><ul><li><p>Facade : 外观类，知道哪些子系统类负责处理请求，将客户端的请求代理给适当的子系统对象.</p></li><li><p>Subsystem : 子系统类，可以有一个或者多个子系统，实现子系统的功能，处理外观类指派的任务，注意子系统类不含有外观类的引用.</p></li></ul><p>&emsp;&emsp;好，接下来我们就用外观模式把上面的例子改写下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Facade</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">     Head head;</span><br><span class="line">    Body body;</span><br><span class="line">    Limb limb;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Facade</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        head = <span class="keyword">new</span> Head();</span><br><span class="line">        body = <span class="keyword">new</span> Body();</span><br><span class="line">        limb = <span class="keyword">new</span> Limb();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeHuman</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        head.makeHead();</span><br><span class="line">        body.makeBody();</span><br><span class="line">        limb.makeLimb();</span><br><span class="line">        System.out.println(<span class="string">"成人形了..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里其实我们添加个类，在初始化该类的同时将各个子系统类创建好，再提供一个方法将子系统类的方法或属性进行组合，以备外界调用，所以这个类便是外观类，当然了，这里为了简单演示，没有考虑将方法或属性组合，比如造人是男人还是女人，是瘦的还是胖的等等。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;    </span><br><span class="line">        Facade facade = <span class="keyword">new</span> Facade();</span><br><span class="line">        facade.makeHuman();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 输出结果：</span><br><span class="line">捏个头</span><br><span class="line">揉成身体</span><br><span class="line">插上四肢</span><br><span class="line">成人形了...</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;客户端的代码非常简单，由于 Facade 的作用，客户端可以根本不知子系统类的存在。外观模式本身就是将子系统的逻辑和交互隐藏起来，为用户提供一个高层次的接口，使得系统更加易用，同时也隐藏了具体的实现，这样一来，即使具体的子系统类发生了变化，用户也感知不到。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;在最后我们来简单总结下 ：</p><p><code>使用场景 :</code></p><ul><li><p>维护遗留系统，让新系统与外观类交互，外观类则负责与老代码进行交互.</p></li><li><p>构建有层次结构的子系统时，使用外观模式给每个子系统定义入口，通过外观类进行通信，减少子系统类之间的依赖关系.</p></li></ul><p><code>优点 ：</code></p><ul><li><p>隐藏了子系统具体实现，减少耦合，即使具体子系统发生变化用户也感知不到.</p></li><li><p>减少系统的相互依赖，所有依赖都是对外观类的依赖，和子系统类无关.</p></li></ul><p><code>缺点 ：</code></p><ul><li>不符合开放封闭原则，假如出现变更，可能要修改外观类.</li></ul><p><div align="center"><img src="http://wx1.sinaimg.cn/mw690/0060lm7Tly1fvdwptvfxxj30kb08ujrv.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Facade 结构图</div></p><p>&emsp;&emsp;对于面向对象有一定基础的同学，即使没有听说过外观模式，在很多时候也可能经常使用它，所以外观模式是非常常用的模式之一。</p><p>&emsp;&emsp;最后十三再说一下，自从女娲那次造人后就再也没有造人了，为什么呢？事后据女娲回忆说，她后来发现人类自己已经学会如何造人……哈哈！<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，今天我们来讲讲如何造人，哦不……还是设计模式的学习，继续搬砖！&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="外观模式" scheme="http://Binshao.site/tags/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>校园爱情故事后记</title>
    <link href="http://Binshao.site/2018/07/21/Proxy/"/>
    <id>http://Binshao.site/2018/07/21/Proxy/</id>
    <published>2018-07-21T06:24:40.000Z</published>
    <updated>2018-09-18T06:38:23.652Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，不知道是不是越长大就更难做到坚持……</p></blockquote><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdodj2pdgj30zk0mtdor.jpg" alt=""></div></p><a id="more"></a><p><br>    </p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;自从上次十三有了女神闺蜜的情报，十三最后是否成功抱得美人归呢？这可能是个谜，因为写这篇文章的十三自己都不知道呢，嘿嘿。好吧，说着说着话题都偏了…不知道十三在说啥的同学，请到传送门接受安检 <a href="https://binshao.site/2018/07/19/Observer/">十三校园泡妞记</a>。</p><p>&emsp;&emsp;有了闺蜜的精准情报，十三每次自然不会扑空，只是当十三想要上去搭讪或是有进一步动作的时候，十三就怂了，没错，怂了。他害怕又感些许自卑，可又担心这样下去会失去，就这样一直循环重复，就连卧底闺蜜都抱怨十三太怂了，嚷嚷着不提供情报了，可每次看到十三那一脸痴情样又叹了口气。</p><p>&emsp;&emsp;某天晚上，十三手捧着束花，他动作熟练地打开手机微信，发了条信息，上面写着：“恩人阿恩人，我在你楼下帮我送束花给她吧，您的大恩大德永不忘！”，没过多久，对方回信：“可以啊，还懂得送花了，开窍了，不过自己送。”，原来十三想送花给女神，可他又不好意思当面送，看来十三是真的怂…只好委托她闺蜜帮他送花了，只是人家并不答应他，最后还是十三提出请她吃大餐才答应送花的…</p><p>&emsp;&emsp;注意，这里开始可是要画风突变了，上面这个委托送花过程其实可以用到个设计模式，它便是代理模式，好，接下来我们一起来看看代理模式的介绍。<br><br></p><h2 id="代理模式-Proxy"><a href="#代理模式-Proxy" class="headerlink" title="代理模式 (Proxy)"></a>代理模式 (Proxy)</h2><p>&emsp;&emsp;代理模式也被称为委托模式，它是结构型设计模式的一种。在我们平时日常生活中类似代理模式的场景也非常常见，比如说请律师代理打官司、代理工具上网等等。</p><p><code>定义：为其他对象提供一种代理以控制对这个对象的访问.</code></p><p>代理模式中的角色及职责 ：</p><ul><li><p>Subject : 抽象主题类，声明真实主题与代理的共同接口方法.</p></li><li><p>RealSubject : 真实主题类，代理类所代表的真实主题，客户端通过代理类间接地调用真实主题类的方法.</p></li><li><p>Proxy : 代理类，持有对真实主题类的引用，在其所实现的接口方法中调用真实主题类中相应的接口方法执行.</p></li></ul><p>&emsp;&emsp;学了就要用，接下来我们把上面十三委托送花的事用代理模式简单实现下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GiveGift</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GiveFlowers</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们先定义了一个抽象主题接口，抽象主题类它具有真实主题类和代理的共同接口方法，而这个共同方法就是送花了，所以在里面提供了 GiveFlowers 这个方法，继续往下看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pursuit</span> <span class="keyword">implements</span> <span class="title">GiveGift</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String girlName;</span><br><span class="line">    <span class="keyword">private</span> String boyName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Pursuit</span><span class="params">(String girlName, String boyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.girlName = girlName;</span><br><span class="line">        <span class="keyword">this</span>.boyName = boyName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GiveFlowers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(girlName + <span class="string">","</span> + boyName + <span class="string">"送你花耶！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;然后我们定义了个追求者类，它实现了抽象主题类并重写接口里面的方法，实际上，它是代理模式中真实主题类这个角色，在送花这里十三无疑便是这个角色了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">GiveGift</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String proxyName;</span><br><span class="line">    Pursuit pursuit;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Proxy</span><span class="params">(String proxyName, String girlName, String boyName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.proxyName = proxyName;</span><br><span class="line">        pursuit = <span class="keyword">new</span> Pursuit(girlName, boyName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GiveFlowers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.print(proxyName + <span class="string">":"</span>);</span><br><span class="line">        pursuit.GiveFlowers();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接下来就是代理类了，它同样也是实现了抽象主题接口，我们可以看到它持有对真实主题类的引用，并在重写的接口方法中调用真实主题类重写的接口方法，也就是说，闺蜜代理帮十三完成送花这个动作，之所以通过调用真实主题类重写的方法，是因为这是十三委托我们的闺蜜帮他送花。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Subject proxy = <span class="keyword">new</span> Proxy(<span class="string">"LL闺蜜"</span>, <span class="string">"LL"</span>, <span class="string">"十三"</span>);</span><br><span class="line">        proxy.GiveFlowers();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LL闺蜜:LL,十三送你花耶！</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;客户端的代码非常简单，我们直接通过代理对象并调用相关方法就完成了送花这个动作，最终调用的是真实主题类里实现的方法，我们这里就成功使用代理模式做了个简单实现。</p><p>&emsp;&emsp;事实上上面我们写的例子是静态代理，代理模式主要分为静态代理和动态代理。<code>静态代理在代码运行前就已经存在了代理类的 class 编译文件；动态代理则是在运行时通过反射来动态生成代理类的对象，并确定是谁来代理。</code><br><br></p><h2 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h2><p>&emsp;&emsp;既然静态代理我们上面已经实现过了，那么这个动态代理应该怎么来做呢？别急，JDK 提供了相关的类库供我们使用，InvocationHandler 是代理实例的调用程序实现的接口，实现了该接口需要重写 invoke() 方法，那么下面我们用十三送花这个例子来实现动态代理 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DynamicProxy</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object object;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DynamicProxy</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.object = object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在代理实例上处理方法调用并返回结果</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] arg)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object result = method.invoke(object, arg);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们先声明了一个 Object 对象，它指向引用与真实主题类，也就是被代理类，紧接着我们在重写的 invoke 方法中去调用执行被代理类的具体方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Subject realSubject = <span class="keyword">new</span> Pursuit(<span class="string">"LL"</span>, <span class="string">"十三"</span>);</span><br><span class="line">        DynamicProxy mDynamicProxy = <span class="keyword">new</span> DynamicProxy(realSubject);</span><br><span class="line">        ClassLoader loader = Pursuit.class.getClassLoader();</span><br><span class="line">        Subject dynamicProxy = (Subject) java.lang.reflect.Proxy.</span><br><span class="line">                newProxyInstance(loader, <span class="keyword">new</span> Class[]&#123;Subject.class&#125;, mDynamicProxy);</span><br><span class="line">        dynamicProxy.GiveFlowers();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后我们得要在客户端调用 Proxy.newProxyInstance() 方法来生成动态代理类，接着通过它去调用 GiveFlowers() 方法，而它则会去调用上面我们写的 DynamicProxy 类中的 invoke 方法，这样我们便简单完成了动态代理。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LL,十三送你花耶！</span><br></pre></td></tr></table></figure><p><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;那么到最后我们来简单总结下 ：</p><p><code>使用场景 （通过网络搜索，一般分下面几种）:</code></p><ul><li><p>远程代理，也就是为一个对象在不同的地址空间提供局部代表，这样便于隐藏.</p></li><li><p>虚拟代理，根据需要创建开销很大的对象，通过它来存放实例化需要很长时间的真实对象.</p></li><li><p>安全代理，用来控制真实对象访问时的权限.</p></li><li><p>智能指引，当调用真实对象时，代理处理另外一些事.</p></li></ul><p><code>优点 ：</code></p><ul><li><p>真实主题类只需关心本职工作.</p></li><li><p>即使真实主题类发生变化，代理类仍然不受影响，因为真实主题类实现了公共接口.</p></li></ul><p>这里来张代理模式的合照，一 二 三，茄子 ： </p><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdopc4qhej30jp091aao.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Proxy 结构图<br><br></div></p><h2 id="后话"><a href="#后话" class="headerlink" title="后话"></a>后话</h2><p>&emsp;&emsp;后来，LL 收到了十三送的花，其实 LL 知道十三喜欢她，因为闺蜜已经把什么都和她说了…LL 拿着花并轻轻说了句：“呆子！“。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，不知道是不是越长大就更难做到坚持……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdodj2pdgj30zk0mtdor.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="代理模式" scheme="http://Binshao.site/tags/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之享元模式</title>
    <link href="http://Binshao.site/2018/07/20/Flyweight/"/>
    <id>http://Binshao.site/2018/07/20/Flyweight/</id>
    <published>2018-07-20T05:52:45.000Z</published>
    <updated>2018-09-18T06:05:50.257Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。天气好热都要融化了，恐怖的三伏天……</p></blockquote><p><div align="center"><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdnij8wf0j30u00k3t9s.jpg" alt=""></div></p><a id="more"></a><p><br></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;这是设计模式系列的第 十 篇学习记录，天气还是那么炎热，我盼望着富婆的到来，我不想努力了，然而什么都没有出现，继续搬砖…</p><p>&emsp;&emsp;在开始我们今天的学习前，十三首先问大家一个基础的问题，假设现在有 两 个字符串对象，它们的内容也就是赋值相同，那么它们是同一个对象吗？我们先用代码描述出来先 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String str = <span class="string">"LL"</span>;</span><br><span class="line">        String text = <span class="string">"LL"</span>;</span><br><span class="line">        System.out.println(str == text);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;那么最后我们运行程序的结果是什么呢，是 true 还是 false 呢？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;没错，答案是 true，我们知道在 Java 中字符串常量都是存放在常量池中的，Java 会确保 一 个字符串常量在常量池中只有 一 个拷贝，并且 String 对象是 final 类型，对象一旦创建就不可改变。在平时开发中，会出现许多 String 类型的变量，如果只是小应用倒还好,假设是一个庞大的系统,有好多处都需要用定义 String 类型的变量，那开销可想而知，而 JDK 的开发者自然想到了这点，采用了享元模式解决创建大量相同 String 变量带来的开销问题。</p><p>&emsp;&emsp;那么问题就来了，这个享元模式到底是什么呢？我们接着往下看。<br><br></p><h2 id="享元模式"><a href="#享元模式" class="headerlink" title="享元模式"></a>享元模式</h2><p>&emsp;&emsp;享元模式是池技术的重要实现方式，它不仅可以减少应用程序创建的对象，而且降低了程序内存的占用，提高程序的性能。</p><p><code>定义：使用共享对象有效地支持大量细粒度的对象.</code></p><p>&emsp;&emsp;支持大量细粒度对象，就会使得对象数量多并且性质基本上是相同的，这些对象分为两部分：内部状态和外部状态。</p><p>&emsp;&emsp;内部状态是对象可分享出来的信息，存储在享元对象内部并且不会随环境的改变而改变；如上面的字符串例子中，字符串对象具有字符串类型的特性，这些特性是每个字符串对象都拥有的且是不会改变的。</p><p>&emsp;&emsp;外部状态则是对象依赖的一个标记，它是随环境改变而改变的并且不可共享的状态。如每个字符串对象的内容都可能会不同，它是会随时变化的。</p><p>享元模式中的角色及职责 ：</p><ul><li><p>Flyweight : 抽象享元角色，同时定义出对象的外部状态和内部状态的接口或者实现.</p></li><li><p>ConcreteFlyweight: 具体享元角色，实现抽象享元角色定义的业务方法.</p></li><li><p>FlyweightFactory: 享元工厂，负责管理对象池和创建享元对象.</p></li></ul><p>&emsp;&emsp;光说不练假把式，咱们这里我们就以一个线上手机商城为例子把享元模式用起来 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Phone</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showPrice</span><span class="params">(String phone_Name)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们先定义了一个接口，里面分别提供了 showPrice 这个方法，它便对应模式里抽象享元这个角色。我们接着往下看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple_Phone</span> <span class="keyword">implements</span> <span class="title">Phone</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String phoneName;</span><br><span class="line">    <span class="keyword">private</span> String version;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Apple_Phone</span><span class="params">(String phoneName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.phoneName = phoneName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showPrice</span><span class="params">(String version)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (version.equals(<span class="string">"32G"</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"price : 5199 元"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (version.equals(<span class="string">"64G"</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"price : 5699 元"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着我看到这里定义了个类，它实现了前面我们定义的抽象享元角色接口并实现了接口里的方法，那么它对应的角色便是具体享元这个角色了。除了实现接口方法外，我们还定义两个字段属性和构造方法，字段属性分别是手机名字以及手机型号。好，我们继续往下面看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PhoneFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, Apple_Phone&gt; pool = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Phone <span class="title">getPhone</span><span class="params">(String PhoneName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (pool.containsKey(PhoneName)) &#123;</span><br><span class="line">            System.out.println(<span class="string">"使用共享对象,手机型号为："</span> + PhoneName);</span><br><span class="line">            <span class="keyword">return</span> pool.get(PhoneName);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Apple_Phone phone = <span class="keyword">new</span> Apple_Phone(PhoneName);</span><br><span class="line">            pool.put(PhoneName, phone);</span><br><span class="line">            System.out.println(<span class="string">"创建手机对象,手机型号为："</span> + PhoneName);</span><br><span class="line">            <span class="keyword">return</span> phone;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们看到这个类名带有 Factory，那么想都不用想，它就是享元工厂类这个角色了。享元工厂是用来创建享元对象的，它通过 Map 容器来存储对象，将内部状态的属性作为 Map 的 key，这里我们手机的内部状态便是 PhoneName，不管怎么样手机名字是不会改变的。然后我们进行判断，如果 Map 容器包含这个 key，那我们就使用 Map 容器存储的这个对象；否则就新创建对象并放入 Map 容器中，以达到共享的目的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Apple_Phone phoneA = (Apple_Phone) PhoneFactory.getPhone(<span class="string">"iPhone 8"</span>);</span><br><span class="line">        phoneA.showPrice(<span class="string">"64G"</span>);</span><br><span class="line">        Apple_Phone phoneB = (Apple_Phone) PhoneFactory.getPhone(<span class="string">"iPhone 8"</span>);</span><br><span class="line">        phoneB.showPrice(<span class="string">"32G"</span>);</span><br><span class="line">        Apple_Phone phoneC = (Apple_Phone) PhoneFactory.getPhone(<span class="string">"iPhone 8"</span>);</span><br><span class="line">        phoneC.showPrice(<span class="string">"64G"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">创建手机对象,手机型号为：iPhone 8</span><br><span class="line">price : 5699 元</span><br><span class="line">使用共享对象,手机型号为：iPhone 8</span><br><span class="line">price : 5199 元</span><br><span class="line">使用共享对象,手机型号为：iPhone 8</span><br><span class="line">price : 5699 元</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后我们通过运行结果可以得到，首先由于是第一次创建对象，Map 容器中并没有存储这个对象，所以它便新建对象便存储到 Map 容器中，接下来，只要再创建对象时便直接使用 Map 容器存储的对象。我们在回过头来想下，在这里，手机名字作为内部状态它是不会改变的，而手机型号则是外部状态它的值是会变化的，当然最终的手机价格也会发生改变。如此一来，因为有了共享对象，节约了开销。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>那么到最后我们来简单总结下 ：</p><p><code>使用场景 :</code><br>如果一个应用程序使用了大量的相似对象，而这些大量的对象造成了很大的存储开销就应该考虑使用；当需要缓冲池的场景。</p><p><code>优点 ：</code><br>减少应用程序创建的对象，降低程序内存的占用，提高程序的性能。</p><p>最后来张观察者模式的合照 ： </p><p><div align="center"><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdnp4k285j30ui09s3zk.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Flyweight 结构图</div></p><p>&emsp;&emsp;好了，关于享元模式的学习记录就到这里了，天气那么热，各位注意防晒和多吃点水果。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。天气好热都要融化了，恐怖的三伏天……&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdnij8wf0j30u00k3t9s.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="享元模式" scheme="http://Binshao.site/tags/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>十三校园泡妞记</title>
    <link href="http://Binshao.site/2018/07/19/Observer/"/>
    <id>http://Binshao.site/2018/07/19/Observer/</id>
    <published>2018-07-19T05:01:09.000Z</published>
    <updated>2018-09-18T05:48:53.182Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。一首华仔《暗里着迷》送给大家，怎样，是不是很符合气氛！</p></blockquote><p><div align="center"><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdmh8muk6j30zk0npaca.jpg" alt=""></div></p><a id="more"></a><p><div align="center"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29723022&auto=1&height=66"></iframe></div></p><h2 id="心动的感觉"><a href="#心动的感觉" class="headerlink" title="心动的感觉"></a>心动的感觉</h2><p>&emsp;&emsp;这是设计模式系列的第 九 篇学习记录，什么，你 TM 在逗我，我要看的是妹子，你个标题党！大兄弟，你，你先别急，上吊也得喘口气，且听我娓娓道来……</p><p>&emsp;&emsp;很多人都说大学一定要谈一场轰轰烈烈的恋爱，不然大学不算完整，十三在这之前可能对这些不太上心，觉得谈恋爱还不如打代码来的爽快实在，可十三最近却变了，他变得不再像以前那样那么勤快地敲代码了，不仅这样，他一下子觉得生活仿佛失去了色彩，饭也吃不香，觉也睡不香，大家可能会奇怪了，怎么回事，多上进的小伙子，怎么一下成那样了？</p><p>&emsp;&emsp;十三说这些天他遇见了个妹子，第一眼看见便感很有眼缘，不免多看了几眼。此后几天，不管十三去哪都总能遇见她，总是那么的碰巧，犹如磁石那般有磁性，又像是被安排好一样，只待你走出场来。十三顿时觉得这感觉好奇妙，说不清道不明，每次看到她内心就好高兴可脸上却又一脸淡定，直到人家走远了又觉好失落，十三反问自己这是怎么了同时发现自己又好矛盾，然后就这样慢慢沦陷…</p><p>&emsp;&emsp;晚上，十三决定和兄弟们谈谈心，”都别敲代码了，咱们来聊聊。“，十三对着哥几个说道，”哟，今儿咋怎么有兴致。“，十三接着便把进来情况说了出来，一听见是关于妹子，宿舍几个基佬立马就围了过来…</p><p>&emsp;&emsp;“你是不是看上人家啦，你觉得她哪里好阿？”，一哥们问道。</p><p>&emsp;&emsp;只见十三脑袋微微左倾，像是在回忆似的，“我也不知道怎么说，每次看到她就好开心，看到她在饭堂拿着一碗盛满的热汤，小心翼翼地放下后烫得立马甩手，还吐着小舌头，我就觉得她好可爱；一次在饭堂外的洗水池，我洗完手后不小心撞到一位同学，然后我和这位同学竟然异口同声地说了句不好意思，待我定睛一看，居然是她，那个时候，我看着她我整个人都愣在那里了，要是可以，我希望时间可以静止在那！”。</p><p>&emsp;&emsp;”完了，这家伙坠入爱河了！那等什么阿，追她！“。</p><p>&emsp;&emsp;”对，上啊，追她，哥几个帮你制定作战计划！“，其他哥们纷纷附和着。</p><p>&emsp;&emsp;”知己知彼，百战百胜，我们首先收买她闺蜜，让她做我们的线人给你制造机会。“。</p><p>&emsp;&emsp;好主意，十三点点头暗暗想到。事实上，这个泡妞计划可以应用到设计模式中的观察者模式(画风突变，嘿嘿)。<br><br></p><h2 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h2><p>&emsp;&emsp;观察者模式又叫做发布-订阅模式，属于行为型设计模式中的一种，在我们平时的开发中经常用到。</p><p><code>观察者模式定义了一种一对多的依赖关系，让多个观察者对象同时监听某一个主题对象。这个主题对象在状态发生变化时，会通知所有观察者对象，使它们能够自动更新自己。</code></p><p>观察者模式中的角色及职责 ：</p><ul><li><p>Subject : 抽象主题(抽象被观察者)，抽象主题角色把所有观察者对象保存在一个集合里，每个主题都可以有任意数量的观察者。抽象主题提供一个接口，可以增加和删除观察者对象.</p></li><li><p>ConcreteSubject : 具体主题(具体被观察者)，该角色将有关状态存入具体观察者对象，在具体主题的内部状态发生改变时，给所有注册过的观察者发送通知.</p></li><li><p>Observer : 抽象观察者，是观察者的抽象类，它定义了一个更新接口，使得在得到主题更改通知时更新自己.</p></li><li><p>ConcreteObserver : 具体观察者，实现抽象观察者定义的更新接口，以便在得到主题更改通知时更新自身的状态.</p></li></ul><p>&emsp;&emsp;理论概念说了一大堆，咱们来点实在的 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们先定义了一个接口，里面分别提供了 attach、detach、notify 三个方法，它便对应模式里抽象主题这个角色。我们接着往下看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GirlSubject</span> <span class="keyword">implements</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">GirlSubject</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Observer&gt; boyList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        boyList.add(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">(Observer observer)</span> </span>&#123;</span><br><span class="line">        boyList.remove(observer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">notify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Observer observer : boyList) &#123;</span><br><span class="line">            System.out.println(name + <span class="string">":"</span> + message);</span><br><span class="line">            observer.update();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着我看到这里定义了个类，它实现了前面我们定义的抽象主题接口并实现了接口里的方法，那么它对应的角色便是具体主题这个角色了。在我们的泡妞计划中，这个类便是我们收买的线人了，我们还可以看到类里还有个容器，这个容器存储的便是十三这个观察者了，当然了，它可以有多个观察者，可这样一来，十三就会不高兴了，这意味着他有情敌。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里这个接口便是抽象观察者了，它里面提供了一个更新方法。然后我们再开看看具体实现它的具体观察者 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoyObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BoyObserver</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">":"</span> + <span class="string">"收到，等我抱得美人归，请你吃饭！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;同样具体观察者类实现了抽象观察者接口里的方法，在计划中这个类便是对应十三这个观察者了。好了，拟定好作战计划好，那么我们就要行动起来 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        BoyObserver boy = <span class="keyword">new</span> BoyObserver(<span class="string">"十三"</span>);</span><br><span class="line"></span><br><span class="line">        GirlSubject girl = <span class="keyword">new</span> GirlSubject(<span class="string">"LL室友"</span>);</span><br><span class="line">        girl.attach(boy);</span><br><span class="line">        girl.notify(<span class="string">"LL出门啦，快去追她！"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LL室友: LL出门啦，快去追她！</span><br><span class="line">  十三: 收到，等我抱得美人归，请你吃饭！</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样子，我们这个作战计划便用了观察者模式来手动实现了，手动？难道还有其他不用手动的方法吗？当然了…<br><br></p><h2 id="Observable-和-Observer"><a href="#Observable-和-Observer" class="headerlink" title="Observable 和 Observer"></a>Observable 和 Observer</h2><p>&emsp;&emsp;其实 Java JDK 下已经有提供了相关的类库帮助我们快速实现观察者模式，它们分别是 Observable 类 和 Observer 接口，下面我们来看看怎么样来应用 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteSubject</span> <span class="keyword">extends</span> <span class="title">Observable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteSubject</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getNotify</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">        System.out.println(name +<span class="string">":"</span> + <span class="string">"LL出门啦，快去追她！"</span>);</span><br><span class="line">        setChanged();</span><br><span class="line">        notifyObservers(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里个类便是具体主题(具体被观察者)，它继承了 JDK 包下的 Observable 这个类，在我们自己编写的 getNotify 方法中，当我们的被观察者状态发生改变后，我们直接调用继承的这个 Observable 这个类的 setChanged() 这个方法，它用来设置一个内部标志位注明状态发生了变化，而 notifyObservers() 方法会去调用一个列表中所有的 Observer 的 update() 方法，以通知它们被观察对象状态发生了变化。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteObserver</span> <span class="keyword">implements</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConcreteObserver</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(Observable o, Object object)</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">":"</span> + <span class="string">"收到，等我抱得美人归，请你吃饭！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接着这个类也就是我们的具体观察者，它实现了 Observer 这个接口，我们实现了它的 update()方法，也就是当被观察者的状态发生改变时，观察者的状态也随之更新。最后我们来看看结果 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        ConcreteSubject subject = <span class="keyword">new</span> ConcreteSubject(<span class="string">"LL闺蜜"</span>);</span><br><span class="line">        ConcreteObserver observer = <span class="keyword">new</span> ConcreteObserver(<span class="string">"十三"</span>);</span><br><span class="line"></span><br><span class="line">        subject.addObserver(observer);</span><br><span class="line"></span><br><span class="line">        subject.getNotify(<span class="string">"LL出门啦，快去追她！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LL闺蜜: LL出门啦，快去追她！</span><br><span class="line">  十三: 收到，等我抱得美人归，请你吃饭！</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;通过实现 JDK 包下的提供的类库，我们同样也能实现观察者模式，而且相比与我们自己来手动实现，无疑使用官方提供的类库，我们可以更快地实现。但是十三还是推荐自己动手去实践下再用提供好的类库来实现，因为只有自己去动手操作，才能加深印象。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>那么到最后我们来简单总结下 ：</p><p><code>使用场景 :</code><br>&emsp;&emsp;当一个对象的改变需要同时改变其他对象的时候，并且它还不知道具体有多少对象待改变时，我们应该考虑观察者模式，此外，如 Android 中的广播也是相关的应用场景。</p><p><code>优点 ：</code></p><ul><li><p>观察者和被观察者之间是抽象耦合并且容易扩展.</p></li><li><p>双方的耦合都依赖于抽象，使得各自之间的变化不会影响到另一边.</p></li></ul><p>最后来张观察者模式的合照 ： </p><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdmuiw7iaj30vk09cwfn.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Observer 结构图</div></p><p>&emsp;&emsp;好了，关于观察者模式的学习记录就到这里了，也希望各有情人终成眷属，最后十三想说的是，十三目前还是单身……绝没有任何秀恩爱之说，Ok，Goodbye！<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。一首华仔《暗里着迷》送给大家，怎样，是不是很符合气氛！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdmh8muk6j30zk0npaca.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="观察者模式" scheme="http://Binshao.site/tags/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>爆发雄性荷尔蒙——从玩改装赛车中学习装饰模式</title>
    <link href="http://Binshao.site/2018/07/18/design-decorator/"/>
    <id>http://Binshao.site/2018/07/18/design-decorator/</id>
    <published>2018-07-18T01:13:49.000Z</published>
    <updated>2018-09-18T05:00:17.862Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。时间一晃假期便过了三天，我人生中最后一个暑假，你慢点走…</p></blockquote><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdgj1txi8j30zk0fh0wh.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: red;">今晚八点秋名山见…</div></p><a id="more"></a><p>&emsp;&emsp;这是设计模式系列的第 八 篇学习记录，假期也要坚持学习，加油！</p><p>&emsp;&emsp;上篇文章中咱们说到我们自己盖了一套花园别墅，一脸懵逼和不明所以的同学请到传送门接受安检 <a href="https://binshao.site/2018/07/17/Builder/">设计模式之建造者模式</a>。</p><p>&emsp;&emsp;有了房我们就满足了吗？当然没有，人心不足蛇吞象，我十三今天还得有辆车，喝最烈的酒、骑最野的马、泡最辣的妞……嗯哼哼，那个，最近几天怕不是活在了梦里哦。废话少说，你今天还开不开车，哦不，还造不造车……</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们定义了个接口，既然是车子那肯定会跑，也就是对应 run 方法，而 show 方法则是显示车子属性，代码非常简单，我们接着往下看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PandaCar</span> <span class="keyword">implements</span> <span class="title">Car</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE_86最高时速..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们创建了个 AE86 汽车类，有哪个老司机开过，嘿嘿？走，咱去车库取车去溜溜 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Car car = <span class="keyword">new</span> PandaCar();</span><br><span class="line">        car.show();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;不错，开着 86 出去感觉街上的小姐姐都往着看，但是看过 《头文字D》 的老司机都知道，86 瘫痪了紧接着换上了更恐怖的引擎，简直爆炸输出阿！人的欲望永远都不会满足的，不行，这辆 86 我也要拿去改装 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunCar</span> <span class="keyword">implements</span> <span class="title">Car</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86最强跑车引擎..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 改装前</span></span><br><span class="line">        Car car = <span class="keyword">new</span> PandaCar();</span><br><span class="line">        car.show();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 改装后</span></span><br><span class="line">        Car Runcar = <span class="keyword">new</span> RunCar();</span><br><span class="line">        Runcar.show();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这下子我们便有最强马力输出的 AE86 了，可是这时我们回过头想下，假若我们要想再进行改装，那我们还得再增加子类并重写方法，虽然说我们这样写的思路是没有错，可是我们还有其他更好的方法吗？<br><br></p><h2 id="装饰模式-Decorator"><a href="#装饰模式-Decorator" class="headerlink" title="装饰模式 (Decorator)"></a>装饰模式 (Decorator)</h2><p>&emsp;&emsp;装饰模式又叫做包装模式，是结构型设计模式之一，其在不必改变类文件和使用继承的情况下，动态地扩展一个对象的功能，是继承的替代方案之一。</p><p><code>定义：动态地给一个对象添加一些额外的职责，就增加功能来说，装饰模式比生成子类更为灵活。</code></p><p>装饰模式中角色和职责 ：</p><ul><li><p>Component : 抽象组件，可以是接口或是抽象类，被装饰的最原始的对象.</p></li><li><p>ConcreteComponent : 组件具体实现类，被装饰的具体对象.</p></li><li><p>Decorator : 抽象装饰者，从外类来扩展 Component 类的功能，但对于 Component 来说无须知道 Decorator 的存在.</p></li><li><p>ConcreteDecorator : 装饰者的具体实现类.</p></li></ul><p>&emsp;&emsp;概念介绍完了之后，我们来看看我们怎么应用装饰模式 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">CarDecorator</span> <span class="keyword">implements</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Car car;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Car <span class="title">getCar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> car;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCar</span><span class="params">(Car car)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.car = car;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CarDecorator</span><span class="params">(Car car)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.car = car;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们定义了个 CarDecorator 抽象类，这里可以看到在它的属性有一个 private 变量指向 Component 抽象组件，所以这个 CarDecorator 便对应角色中的 Decorator，接着我们继续往下看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlyCarDecorator</span> <span class="keyword">extends</span> <span class="title">CarDecorator</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FlyCarDecorator</span><span class="params">(Car car)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(car);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对车进行改装</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86氮气加速+后尾翼..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run();</span><br><span class="line">        <span class="keyword">this</span>.fly();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getCar().show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;可以看到这个类继承自 CarDecorator 类，它就是具体的装饰者实现类，也就是对应着角色中的 ConcreteDecorator，我们来看下在 Main 方法里的代码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Car car = <span class="keyword">new</span> RunCar();</span><br><span class="line">        System.out.println(<span class="string">"跑车 —— 无改装:"</span>);</span><br><span class="line">        car.show();</span><br><span class="line">        Car flyCar = <span class="keyword">new</span> FlyCarDecorator(car);</span><br><span class="line">        System.out.println(<span class="string">"跑车 —— 改装飞行属性:"</span>);</span><br><span class="line">        flyCar.show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;为了方便查看运行结果，我们添加了些打印语句，来看下 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">跑车 —— 无改装:</span><br><span class="line">AE86最强跑车引擎...</span><br><span class="line">跑车 —— 改装飞行属性:</span><br><span class="line">AE86氮气加速+后尾翼...</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;看，我们在 AE86 的基础上又进行了改装，假若我们还想再在现在这个基础上进行改装，我们只需要这样来做 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwimCarDecorator</span> <span class="keyword">extends</span> <span class="title">CarDecorator</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SwimCarDecorator</span><span class="params">(Car car)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(car);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">swim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"AE86水陆两栖属性..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.run();</span><br><span class="line">        <span class="keyword">this</span>.swim();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.getCar().show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们只需要增加个具体装饰者类就可以了，接着就可以在 Main 方法里调用了 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Car car = <span class="keyword">new</span> RunCar();</span><br><span class="line">        System.out.println(<span class="string">"跑车 —— 无改装:"</span>);</span><br><span class="line">        car.show();</span><br><span class="line"></span><br><span class="line">        Car flyCar = <span class="keyword">new</span> FlyCarDecorator(car);</span><br><span class="line">        System.out.println(<span class="string">"跑车 —— 改装飞行属性:"</span>);</span><br><span class="line">        flyCar.show();</span><br><span class="line"></span><br><span class="line">        Car swimCar = <span class="keyword">new</span> SwimCarDecorator(flyCar);</span><br><span class="line">        System.out.println(<span class="string">"跑车 —— 改装飞行、水陆两栖属性:"</span>);</span><br><span class="line">        swimCar.show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">跑车 —— 无改装:</span><br><span class="line">AE86最强跑车引擎...</span><br><span class="line">跑车 —— 改装飞行属性:</span><br><span class="line">AE86氮气加速+后尾翼...</span><br><span class="line">跑车 —— 改装飞行、水陆两栖属性:</span><br><span class="line">AE86水陆两栖属性...</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样到最后，我们经过改装后的 AE86 就有了跑车引擎 + 飞行属性 + 水陆两栖属性，相比于第一次的写法，我们得要在旧类中添加新代码，而装饰模式却提供了一个好的替代方案，它把每个要装饰的功能放在单独的类中，每个装饰对象只需要关心自己的功能就可以了，不知道大家发现没有，上面的代码是不是和 Java I/O 流代码有点像，事实上，I/O 流也是应用到了装饰者模式。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>那么到最后我们来简单总结下 ：<br><code>使用场景 :</code></p><ul><li><p>可以动态给对象增加功能.</p></li><li><p>在不影响其他对象的情况下，以动态透明的方式给单个对象添加职责.</p></li></ul><p><code>优点 ：</code></p><ul><li><p>可以动态扩展一个对象的功能，在运行时也可以选择不同的装饰器从而实现不同的行为.</p></li><li><p>相比于继承的方式，它更灵活.</p></li><li><p>用户可以根据需要增加新的具体装饰类，而不需要修改原有代码，符合开放——封闭原则.</p></li></ul><p><code>缺点 ：</code></p><ul><li><p>当 Component 内部发生改变时，则会影响所有子类，如装饰类和被装饰者.</p></li><li><p>当出现错误时，寻找错误可能需要逐级排查，这就有点蛋疼.</p></li></ul><p>&emsp;&emsp;最后来张装饰模式的合照 ：</p><p><div align="center"><img src="http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdgikbo1rj30tl0fw40n.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Decorator 结构图</div></p><p>&emsp;&emsp;其实在日常生活中，处处都有装饰模式，如穿衣打扮、室内装潢等等，前提是我们要有发现美的眼睛，码农的世界不止 coding 。<br>好了，今天的学习就记录到这里了，也希望大家早日有房有车，走上人生巅峰。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。时间一晃假期便过了三天，我人生中最后一个暑假，你慢点走…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx4.sinaimg.cn/mw690/0060lm7Tly1fvdgj1txi8j30zk0fh0wh.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div align=&quot;center&quot; style=&quot;font-size: 11px; color: red;&quot;&gt;今晚八点秋名山见…&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="装饰模式" scheme="http://Binshao.site/tags/%E8%A3%85%E9%A5%B0%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>买不起房就自己“盖房”来聊聊建造者模式</title>
    <link href="http://Binshao.site/2018/07/17/Builder/"/>
    <id>http://Binshao.site/2018/07/17/Builder/</id>
    <published>2018-07-17T01:13:23.000Z</published>
    <updated>2018-09-18T01:51:21.070Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。今天把自己的房间整理打扫了下，感觉心情很 nice 阿！</p></blockquote><p>&emsp;&emsp;这是设计模式系列的第 七 篇学习记录。最近有个段子挺火的，具体内容不记得了，大概是说你天天多早起床，然后天天坚持学习，可依旧还是买不起房…阿，房价始终还是压在心里的一块大石，十年生死两茫茫，房价涨，房奴殇。作为还是学生的十三，可能还没那么深的感触，但是按这目前情况来看，这辈子怕是买不起了。既然买不起那我们就自己”盖房子”，好，那我们就来过把瘾……</p><a id="more"></a><p><div align="center"><img src="http://wx3.sinaimg.cn/mw690/0060lm7Tly1fvdg5fzkzxj30zk0np424.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray">先来张图</div></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">House</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String floor;</span><br><span class="line">    <span class="keyword">private</span> String wall;</span><br><span class="line">    <span class="keyword">private</span> String roof;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFloor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> floor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFloor</span><span class="params">(String floor)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.floor = floor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> wall;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setWall</span><span class="params">(String wall)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.wall = wall;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getRoof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> roof;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRoof</span><span class="params">(String roof)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.roof = roof;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(floor + wall + roof);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;都是些非常基础的代码，三个字段属性分别对应着房子的地板、墙壁以及房顶。十三个人喜欢带花园的别墅，咱就来创建个 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 客户直接建房子</span></span><br><span class="line">        House houseD = <span class="keyword">new</span> House();</span><br><span class="line">        houseD.setFloor(<span class="string">"花园别墅地板 -&gt;"</span>);</span><br><span class="line">        houseD.setWall(<span class="string">"花园别墅墙壁 -&gt;"</span>);</span><br><span class="line">        houseD.setRoof(<span class="string">"花园别墅房顶"</span>);</span><br><span class="line">        houseD.display();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">花园别墅地板 -&gt;花园别墅墙壁 -&gt;花园别墅房顶</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;从运行结果中看出，我们先一步步从地板开始建造，到墙壁再到房顶，最后这样我们自己盖了个别墅(YY 的厉害)，只可惜这可住了不了人…哈哈，可是我们回过头来仔细想想，我们盖房子的代码全都是写在客户端里，这明显不是个好办法，而且我们自己来盖房子明显是不够专业的，一般情况下我们都会委托建筑工程队来盖房子，我们只要告诉工程队我要建的是花园别墅就可以了，具体的建造细节我们不需要知道，你只要给我把别墅盖好了就行，所以这里我们可以用到建造者模式。<br><br></p><h2 id="建造者模式-Builder"><a href="#建造者模式-Builder" class="headerlink" title="建造者模式 (Builder)"></a>建造者模式 (Builder)</h2><p>&emsp;&emsp;Builder 模式也叫建造者模式或者生成器模式，是一种对象创建型模式之一，<code>将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。</code>如果我们用了建造者模式，那么用户就只需要指定需要建造的类型就可以得到它们，而具体建造的过程和细节就不需要知道了。</p><p>&emsp;&emsp;建造者模式中角色和职责 ：</p><ul><li><p>Director : 指挥者，用来根据用户需求创建对象，它构建了一个使用 Builder 接口的对象.</p></li><li><p>Builder : 抽象 Builder 类，规范产品的组建，一般由子类实现.</p></li><li><p>ConcreteBuilder : 具体建造者，实现抽象 Builder 类定义的所有方法，并返回组建好的对象.</p></li><li><p>Product : 产品类</p></li></ul><p>说完了概念，那么下面就来看看我们应该怎么使用建造者模式 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">HouseBuilder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeFloor</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeWall</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeRoof</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">getHouse</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;上面的 House 类显然就是 Product 产品类，而这里我们新建了接口，对应的角色便是 Builder 了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VillaBuilder</span> <span class="keyword">implements</span> <span class="title">HouseBuilder</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    House house = <span class="keyword">new</span> House();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeFloor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setFloor(<span class="string">"花园别墅地板 -&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeWall</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setWall(<span class="string">"花园别墅墙壁 -&gt;"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeRoof</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        house.setRoof(<span class="string">"花园别墅屋顶 -&gt;别墅建成"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> House <span class="title">getHouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> house;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;接下来这个类实现了 Builder 类的方法，并且返回了组建好了的实例对象，毫无疑问它就是 ConcreteBuilder 类了。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HouseDirector</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> HouseBuilder builder;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HouseDirector</span><span class="params">(HouseBuilder builder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.builder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">makeHouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        builder.makeFloor();</span><br><span class="line">        builder.makeWall();</span><br><span class="line">        builder.makeRoof();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;然后，我们再新建个类，它持有 Builder 对象的引用并且有通知 Builder 开始创建对象的方法，它对应便是 Director 这个角色了，就好比我们要盖花园别墅，我们找到工程队，并和工程队设计师说我要建的是花园别墅，接着设计师便开始设计别墅建筑风格并指挥通知工人开工。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        HouseBuilder villa = <span class="keyword">new</span> VillaBuilder();</span><br><span class="line">        HouseDirector d = <span class="keyword">new</span> HouseDirector(villa);</span><br><span class="line">        d.makeHouse();</span><br><span class="line">        House villaHouse = villa.getHouse();</span><br><span class="line">        villaHouse.display();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">花园别墅地板 -&gt;花园别墅墙壁 -&gt;花园别墅屋顶 -&gt;别墅建成</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后，我们委托的工程队盖好了别墅，而我们只需要提供类型就可以了，如欧式城堡、四合院等等，至于别墅具体的建造细节我们无须知道，以上便是建造者模式的学习，相比于我们第一次直接在 Main 方法中编写代码，使用建造者模式无疑可扩展性更好。那么，最后我们来总结一下。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;Builder 模式主要用于创建一些复杂的对象，这些对象内部构建间的建造顺序通常是稳定的，但对象内部的构建通常面临这复杂的变化。</p><p>&emsp;&emsp;使用建造者模式可以使客户端不必知道产品内部组成的细节，具体的建造者类之间是相互独立的且容易扩展。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。今天把自己的房间整理打扫了下，感觉心情很 nice 阿！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;这是设计模式系列的第 七 篇学习记录。最近有个段子挺火的，具体内容不记得了，大概是说你天天多早起床，然后天天坚持学习，可依旧还是买不起房…阿，房价始终还是压在心里的一块大石，十年生死两茫茫，房价涨，房奴殇。作为还是学生的十三，可能还没那么深的感触，但是按这目前情况来看，这辈子怕是买不起了。既然买不起那我们就自己”盖房子”，好，那我们就来过把瘾……&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="建造者模式" scheme="http://Binshao.site/tags/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之原型模式</title>
    <link href="http://Binshao.site/2018/07/16/Prototype/"/>
    <id>http://Binshao.site/2018/07/16/Prototype/</id>
    <published>2018-07-16T01:13:10.000Z</published>
    <updated>2018-09-18T01:37:23.901Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。最近把之前的文章删了又重发了，时间上可能不匹配，大家不要觉得奇怪。</p></blockquote><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdfjpxfnqj30zk0nngr9.jpg" alt=""></div></p><a id="more"></a><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>&emsp;&emsp;这是设计模式系列的第 六 篇学习记录，量变引起质变，学习路上还要坚持。今天我们猪脚是原型模式，下面就让我们一起来看看原型模式是什么鬼。<br><br></p><h2 id="原型模式-Prototype"><a href="#原型模式-Prototype" class="headerlink" title="原型模式 (Prototype)"></a>原型模式 (Prototype)</h2><p>&emsp;&emsp;<code>原型模式</code>是一种对象创建型模式，用原型实例指定创建对象的种类，并且通过拷贝这些原型创建新的对象。<br>什么意思呢？别急，我们先简单举个例子，假设我们有个 Person 类，有属性及 Get Set 方法，如下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name: "</span> + name + <span class="string">"  age: "</span> + age + <span class="string">"  sex: "</span> + sex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;代码非常简单，都是些基础，接下来我们在 Main 方法里创建实例 :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">        p.setName(<span class="string">"Binshao"</span>);</span><br><span class="line">        p.setAge(<span class="number">29</span>);</span><br><span class="line">        p.setSex(<span class="string">"Man"</span>);</span><br><span class="line"></span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person();</span><br><span class="line">        p1.setName(<span class="string">"十三"</span>);</span><br><span class="line">        p1.setAge(<span class="number">13</span>);</span><br><span class="line">        p1.setSex(<span class="string">"Man"</span>);</span><br><span class="line"></span><br><span class="line">        p.display();</span><br><span class="line">        p1.display();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;那么运行结果显示就为下面所示 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name: Binshao  age: 29  sex: Man</span><br><span class="line">name: 十三      age: 13  sex: Man</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样子我们创建两个对象就需要两次实例化，假如这时候我们要多个对象岂不是要实例化多次，这可要麻烦死了。而且不知道大家有没有发现，我们上面创建的两个实例对象的基本结构(属性方法等)都是相同的，那我们有没有其他好的解决办法呢？没错，就用我们刚刚提到的原型模式，那么怎么来做呢，放码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 浅克隆</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Person) <span class="keyword">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name: "</span> + name + <span class="string">"  age: "</span> + age + <span class="string">"  sex: "</span> + sex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;首先我们让 Person 类实现 Cloneable 这个接口，Clone 顾名思义便是克隆的意思，Java 本身就有提供支持。接着我们再添加个 clone() 方法用来克隆生成新对象，也就是说通过复制原型(Person)来创建新的实例对象，这便完成了克隆，通过原型模式创建的对象，不仅仅<code>与原型对象具有相同的结构，还与原型对象具有相同的值</code>。<br>眼见为实，让我们来看看结果 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">        p.setName(<span class="string">"Binshao"</span>);</span><br><span class="line">        p.setAge(<span class="number">29</span>);</span><br><span class="line">        p.setSex(<span class="string">"Man"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 克隆 p 对象</span></span><br><span class="line">        Person p1 = p.clone();</span><br><span class="line">        <span class="comment">// 当然我们也可以修改值(仅相对于对象数据是值类型)</span></span><br><span class="line">        <span class="comment">//p1.setName("LL");</span></span><br><span class="line">        <span class="comment">//p1.setAge(13);</span></span><br><span class="line">        <span class="comment">//p1.setSex("Girl");</span></span><br><span class="line"></span><br><span class="line">        p.display();</span><br><span class="line">        p1.display();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name: Binshao  age: 29  sex: Man</span><br><span class="line">name: Binshao  age: 29  sex: Man</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样一看，果然我们克隆的对象和原型对象的值是相同的。当然，我们也可以修改数据值，前提是对象数据(字段)都是值类型的,如果字段是引用类型，克隆对象则复制引用所有变量但不复制引用的对象，也就是说原型对象和克隆对象引用的是同一个对象。事实上，这样的写法叫做浅克隆。</p><p>&emsp;&emsp;一脸懵逼？没事，我们来看看代码，相信大家就会明白了，首先给 Person 类添加个 friend 字段及 get set 方法 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; friends;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getFriends</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFriends</span><span class="params">(List&lt;String&gt; friends)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.friends = friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 浅克隆</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Person) <span class="keyword">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name: "</span> + name + <span class="string">"  age: "</span> + age + <span class="string">"  sex: "</span> + sex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们都知道每个人当然不止一个朋友，所以我们用容器来装载。接下来在 Main 方法里看看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Person per1 = <span class="keyword">new</span> Person();</span><br><span class="line">        List&lt;String&gt; friends = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        friends.add(<span class="string">"Binshao"</span>);</span><br><span class="line">        friends.add(<span class="string">"十三"</span>);</span><br><span class="line">        per1.setFriends(friends);</span><br><span class="line"></span><br><span class="line">        Person per2 = per1.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(per1.getFriends());</span><br><span class="line">        System.out.println(per2.getFriends());</span><br><span class="line"></span><br><span class="line">        friends.add(<span class="string">"LL"</span>);</span><br><span class="line">        per1.setFriends(friends);</span><br><span class="line"></span><br><span class="line">        System.out.println(per1.getFriends());</span><br><span class="line">        System.out.println(per2.getFriends());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Binshao, 十三]</span><br><span class="line">[Binshao, 十三]</span><br><span class="line">[Binshao, 十三, LL]</span><br><span class="line">[Binshao, 十三, LL]</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;从结果我们看到，克隆对象复制引用了原型对象的所有变量，并且克隆对像和原型对象引用的是同一个对象，对应到我们的例子便是你认识的所有朋友我也认识，因为它们都是同个对象所以能不一样才怪…我们希望的是它们之间可以互相不影响，那么这又怎么做才好呢？<br><br></p><h2 id="深度克隆"><a href="#深度克隆" class="headerlink" title="深度克隆"></a>深度克隆</h2><p>&emsp;&emsp;既然有了浅度克隆便有了深度克隆，深度克隆便把引用对象的变量指向克隆过的新对象，而不是原有的被引用的对象，那么我们直接上大招 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; friends;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getFriends</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFriends</span><span class="params">(List&lt;String&gt; friends)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.friends = friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 浅克隆</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">clone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Person) <span class="keyword">super</span>.clone();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 深克隆</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">deepClone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Person per = (Person) <span class="keyword">super</span>.clone();</span><br><span class="line">            List&lt;String&gt; newFriends = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (String friends : <span class="keyword">this</span>.getFriends()) &#123;</span><br><span class="line">                newFriends.add(friends);</span><br><span class="line">            &#125;</span><br><span class="line">            per.setFriends(newFriends);</span><br><span class="line">            <span class="keyword">return</span> per;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name: "</span> + name + <span class="string">"  age: "</span> + age + <span class="string">"  sex: "</span> + sex);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们在这里添加了个深度克隆的方法函数，同样先是获得克隆对象，接着我们通过对 list 容器进行相关赋值，最终返回一个深度克隆的对象，这样一来，克隆对象便把引用对象指向这个复制的新对象，而不是原有的引用对象。最后，我们来验证下看看 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Person per1 = <span class="keyword">new</span> Person();</span><br><span class="line">        List&lt;String&gt; friends = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        friends.add(<span class="string">"Binshao"</span>);</span><br><span class="line">        friends.add(<span class="string">"十三"</span>);</span><br><span class="line">        per1.setFriends(friends);</span><br><span class="line"></span><br><span class="line">        Person per2 = per1.deepClone();</span><br><span class="line"></span><br><span class="line">        System.out.println(per1.getFriends());</span><br><span class="line">        System.out.println(per2.getFriends());</span><br><span class="line"></span><br><span class="line">        friends.add(<span class="string">"LL"</span>);</span><br><span class="line">        per1.setFriends(friends);</span><br><span class="line"></span><br><span class="line">        System.out.println(per1.getFriends());</span><br><span class="line">        System.out.println(per2.getFriends());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Binshao, 十三]</span><br><span class="line">[Binshao, 十三]</span><br><span class="line">[Binshao, 十三, LL]</span><br><span class="line">[Binshao, 十三]</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样一来，果然它们之间可以完全不互相影响。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>最后我们来总结下原型模式 ：</p><ul><li><p>由原型对象自身创建目标对象，也就是说，对象创建这一动作发自原型对象本身.</p></li><li><p>目标对象是原型对象的一个克隆，也就是说，通过 Prototype 模式创建的对象，不仅仅与原型对象具有相同的结构，还与原型对象具有相同的值.</p></li><li><p>根据对象克隆深度层次的不同，有浅度克隆和深度克隆.</p></li></ul><p>Ok，今天就到这里，溜了……<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。最近把之前的文章删了又重发了，时间上可能不匹配，大家不要觉得奇怪。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvdfjpxfnqj30zk0nngr9.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="原型模式" scheme="http://Binshao.site/tags/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>以古代帝皇来讲单例模式</title>
    <link href="http://Binshao.site/2018/07/15/Singletop/"/>
    <id>http://Binshao.site/2018/07/15/Singletop/</id>
    <published>2018-07-15T06:13:01.000Z</published>
    <updated>2018-09-17T08:15:37.713Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，昨天回家了，一早起来继续搬砖，嘿嘿。</p></blockquote><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvclb9i4tyj30zk0k1n44.jpg" alt=""></div></p><a id="more"></a><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>&emsp;&emsp;这是设计模式系列的第 五 篇学习记录，不知道各位大家喜欢读历史吗？十三就非常喜欢看历史，比如《资治通鉴》、《东周列国记》、《三国演义》等等，还记得上小学那会儿在底下看书看得入迷，只是时间一晃就再也不是红领巾了…</p><p>&emsp;&emsp;读史书中总是能看到各个朝代的皇帝，三宫六院，掌握着最高权力，站在食物链顶端俯视着天下，咱还是想想就好…那么对应在软件领域，我们怎么以代码形式来描述呢？</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Secretary</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"大臣：吾皇万岁万岁万万岁!"</span>); </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        King k = <span class="keyword">new</span> King();</span><br><span class="line">        k.setName(<span class="string">"秦始皇"</span>);</span><br><span class="line"></span><br><span class="line">        Secretary s = <span class="keyword">new</span> Secretary();</span><br><span class="line">        s.say();</span><br><span class="line">        k.say();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;那么运行程序就可以看到 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">大臣：吾皇万岁万岁万万岁!</span><br><span class="line">秦始皇: 众爱卿平身.</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;但是我们还忽略了一点就是，我们都知道每个朝代都只能有一个皇上，如果我们像上面那样子来写的话，就会有多个君主这样的情况发生，我们来演示下情况 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Secretary s = <span class="keyword">new</span> Secretary();</span><br><span class="line">        s.say();</span><br><span class="line"></span><br><span class="line">        King king = <span class="keyword">new</span> King();</span><br><span class="line">        king.setName(<span class="string">"秦始皇"</span>);</span><br><span class="line">        king.say();</span><br><span class="line"></span><br><span class="line">        King k = <span class="keyword">new</span> King();</span><br><span class="line">        k.setName(<span class="string">"汉武帝"</span>);</span><br><span class="line">        k.say();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">大臣：吾皇万岁万岁万万岁!</span><br><span class="line">秦始皇: 众爱卿平身.</span><br><span class="line">汉武帝: 众爱卿平身.</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;一个朝代两个皇帝？这估计下面的大臣一脸懵逼…所谓一山不能容二虎，除非是母老虎，那么我们怎么才能避免上面的情况发生呢？——没错，你猜对了，单例模式。<br><br></p><h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><p>&emsp;&emsp;单例模式是一种对象创建型模式，使用单例模式，可以保证为一个类只生成唯一的实例对象，保证一个类只有一个实例存在，同时提供能对该实例加以访问的全局访问方法。</p><p>&emsp;&emsp;好，那么我们就一起来动手写一写这个单例类 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> King k = <span class="keyword">new</span> King();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数私有化，保证不被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">King</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供一个全局的静态方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> King <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们通过这样来改写，它便是一种单例模式的写法，实际上这种写法叫做饿汉式写法，饿汉饿汉，顾名思义，你看，一上来就直接 new 了个对象，能不饥饿？那么我们在 main 方法里测试下看看 :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Secretary s = <span class="keyword">new</span> Secretary();</span><br><span class="line">        s.say();</span><br><span class="line"></span><br><span class="line">        King king = King.getInstance();</span><br><span class="line">        king.setName(<span class="string">"秦始皇"</span>);</span><br><span class="line"></span><br><span class="line">        King k = King.getInstance();</span><br><span class="line">        k.setName(<span class="string">"汉武帝"</span>);</span><br><span class="line">        king.say();</span><br><span class="line">        k.say();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">大臣：吾皇万岁万岁万万岁!</span><br><span class="line">汉武帝: 众爱卿平身.</span><br><span class="line">汉武帝: 众爱卿平身.</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们来看，通过单例类我们去获得了唯一的实例对象，即使我们想修改成两个君主也是修改不了的，这样一来就避免了上面的情况。这种写法在类加载时就完成了初始化，所以类加载较慢但获取对象的速度快，单例模式除了饿汉式写法，还有其他一些写法。<br><br></p><h2 id="懒汉式"><a href="#懒汉式" class="headerlink" title="懒汉式"></a>懒汉式</h2><p>来，骚年上码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> King k;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数私有化，保证不被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">King</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供一个全局的静态方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> King <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> k = <span class="keyword">new</span> King();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;上面就是懒汉式写法，它声明了个静态对象，在用户第一次调用时初始化，在第一次加载的时候它需要实例化，并且在多线程里可是线程不安全的，我们都知道 CPU 调度，那么该怎么改良呢，来把锁试试，第一反应。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> King k;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数私有化，保证不被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">King</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供一个全局的静态方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> King <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> k = <span class="keyword">new</span> King();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样一来我们解决了多线程中访问的问题，可如果这样线程每次调用方法都需要进行同步，无疑会造成不必要的开销。没事，接下来我们开大招。<br><br></p><h2 id="双重锁定-DLC"><a href="#双重锁定-DLC" class="headerlink" title="双重锁定 (DLC)"></a>双重锁定 (DLC)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> King k;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数私有化，保证不被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">King</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供一个全局的静态方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> King <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (King.class) &#123;</span><br><span class="line">                <span class="keyword">return</span> k = <span class="keyword">new</span> King();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们在方法里进行了两次判空，第一次是为了判断实例是否存在，第二次则是判断实例是否为空，通过这样的方式可以保证多线程的安全。写到这，心想这已经是最好的写法，NO，NO，没有最好只有更好，当然了，每种写法都各有其利弊。<br><br></p><h2 id="静态内部类单例模式"><a href="#静态内部类单例模式" class="headerlink" title="静态内部类单例模式"></a>静态内部类单例模式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">King</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数私有化，保证不被实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">King</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提供一个全局的静态方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> King <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> KingHolder.Instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">KingHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> King Instance = <span class="keyword">new</span> King();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName() + <span class="string">": 众爱卿平身."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;只有第一次调用方法时才会去初始化实例对象，不仅确保线程安全并且保证类实例对象的唯一性。<br><br></p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>&emsp;&emsp;单例模式的学习笔记就做到这里了，单例模式在我们平常开发中非常常见，所以也不做太多介绍了。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，昨天回家了，一早起来继续搬砖，嘿嘿。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/0072Lfvtly1fvclb9i4tyj30zk0k1n44.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="单例模式" scheme="http://Binshao.site/tags/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之工厂方法模式</title>
    <link href="http://Binshao.site/2018/07/09/Creator/"/>
    <id>http://Binshao.site/2018/07/09/Creator/</id>
    <published>2018-07-09T00:11:11.000Z</published>
    <updated>2018-09-17T07:52:28.654Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，今天来记录下工厂方法模式的学习。</p></blockquote><p><div align="center"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=31473269&auto=0&height=66"></iframe></div></p><a id="more"></a><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvckphusuij30zk0k0dmi.jpg" alt=""></div></p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>&emsp;&emsp;这是设计模式系列的第 四 篇学习记录，本来今天十三想好好休息一天，可当真的闲下来后却觉得有点虚度光阴的感觉，还是学习去吧…</p><p>&emsp;&emsp;还记得上篇提到水果生产机吗？这里来个传送门 <a href="https://binshao.site/2018/07/07/simpleFactory/">设计模式之简单工厂模式</a>，还没有看过的小伙伴可以先去看看。之前我们就在水果生产机里使用了简单工厂模式来编写指令，我们只需要选择我们想要的水果然后按下按钮(程序运行)，水果生产机便会开始生产。在客户端中(main 方法)我们不用管该用哪个种类的水果实例，我们只需把选择的水果种类交给工厂，工厂便会生产出对应的水果实例。那么问题来了，假如现在十三突然想吃葡萄了，而生产机里还没有葡萄的样本数据(葡萄类)，那么我们就创建呗，然后还要在工厂类里的方法添加多一个分支条件，如下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FruitFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get 方法，获得所有产品对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Fruit <span class="title">getFruit</span><span class="params">(String type)</span> <span class="keyword">throws</span> InstantiationException, </span></span><br><span class="line"><span class="function"> 5IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="comment">// 判断水果种类，这里忽略大小写</span></span><br><span class="line">        <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">"apple"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Apple.class.newInstance();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">"banana"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Banana.class.newInstance();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">"grape"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Banana.class.newInstance();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"请添加该水果样本数据以便生产..."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;可这样一来，便会修改到原有的类，这显然不是个好办法，这样就违背了开放-封闭原则，这可怎么办才好呢？这不，工厂方法模式来了。<br><br></p><h2 id="工厂方法模式"><a href="#工厂方法模式" class="headerlink" title="工厂方法模式"></a>工厂方法模式</h2><p>&emsp;&emsp;那么什么是工厂方法模式呢？还有，它和简单工厂模式又有什么区别呢？别急，我们一个个来看。</p><ol><li><p>工厂方法模式 ： </p><p> 工厂方法模式同样属于类的创建型模式，也被称为多态工厂模式.</p><p> 工厂方法模式的意义是定义一个创建产品对象的工厂接口，将实际创建工作推迟到子类当中，核心工厂类不再负责产品的创建，这样核心类成为一个抽象工厂角色，仅负责具体工厂子类必须实现的接口，这样进一步抽象化的好处是使得工厂方法模式可以使系统在不修改具体工厂角色的情况下引进新的产品，符合开放-封闭原则.</p></li><li><p>工厂方法模式中的角色和职责 ：</p><p> 抽象工厂(Creator) 工厂方法模式的核心，任何工厂类都必须实现这个接口.</p><p> 具体工厂(Concrete Creator) 具体工厂类是抽象工厂的一个实现，负责实例化产品对象.</p><p> 抽象(Product) 工厂方法模式所创建的所有对象的父类，它负责描述所有实例所共有的公共接口.</p><p> 具体产品(Concrete Product) 工厂方法模式所创建的具体实例对象.</p></li></ol><p>&emsp;&emsp;理论概念还是要有，光说不练假把式，接下来我们结合代码来理解下，这里我们的代码还是在上次的水果生产机代码上做修改，好，放码，“驾、驾，吁~”。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FruitFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Fruit <span class="title">getFruit</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppleFactory</span> <span class="keyword">implements</span> <span class="title">FruitFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Fruit <span class="title">getFruit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Apple();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BananaFactory</span> <span class="keyword">implements</span> <span class="title">FruitFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Fruit <span class="title">getFruit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Banana();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;我们先定义了一个创建水果产品对象的抽象工厂接口，然后分别创建两个具体的水果工厂类，它必须实现抽象接口并实例化相应的水果实例，这样子我们就写好了，是不是非常简单，那么我们来测试一下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 获得AppleFactory</span></span><br><span class="line">        FruitFactory af = <span class="keyword">new</span> AppleFactory();</span><br><span class="line">        <span class="comment">// 通过AppleFactory获得apple实例</span></span><br><span class="line">        Fruit apple = af.getFruit();</span><br><span class="line">        apple.get();</span><br><span class="line"></span><br><span class="line">        FruitFactory bf = <span class="keyword">new</span> BananaFactory();</span><br><span class="line">        Fruit banana = bf.getFruit();</span><br><span class="line">        banana.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后运行程序，水果生产机一样也可以生产出水果。那么它与简单工厂模式又有什么区别呢，让我们一起来总结下。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;<code>工厂方法类</code>的核心是一个抽象工厂类，工厂方法模式之所以有一个别名叫多态性工厂模式是因为具体工厂类都有共同的接口，或者有共同的抽象父类。当系统扩展需要添加新的产品对象时，仅仅需要添加一个具体对象以及一个具体工厂对象，原有工厂对象不需要进行任何修改，也不需要修改客户端，很好的符合了开放-封闭原则。</p><p>&emsp;&emsp;<code>简单工厂模式</code>的最大优点在于工厂类中包含了必要的逻辑判断，根据客户端的选择条件动态实例化相应的对象，对于客户端而言，去除了与具体产品之间的依赖，可简单工厂模式在添加新产品对象后不得不修改工厂方法，扩展性不好且不符合开放-封闭原则。</p><p>&emsp;&emsp;最后，我们回过头来想了下，其实无论是简单工厂模式还是工厂方法模式，选择判断(水果种类)的问题还是存在，只不过工厂方法模式是在客户端里，而简单工厂模式则是在工厂类里。十三迷惑的望向远方……<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，今天来记录下工厂方法模式的学习。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=31473269&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="工厂方法模式" scheme="http://Binshao.site/tags/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>哆啦A梦来讲简单工厂模式</title>
    <link href="http://Binshao.site/2018/07/07/simpleFactory/"/>
    <id>http://Binshao.site/2018/07/07/simpleFactory/</id>
    <published>2018-07-07T06:10:24.000Z</published>
    <updated>2018-09-17T07:29:56.313Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，还有几天就放假了，果然学生还是最轻松的职业。</p></blockquote><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvckak8dvkj30b40b4jrn.jpg" alt=""></div></p><a id="more"></a><p><div align="center" style="font-size: 11px; color: red;">给大家打个招呼</div></p><h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>&emsp;&emsp;这是设计模式系列的第 三 篇学习记录，今天做下笔记记录后，估计得缓几天再来记录设计模式系列的学习过程，十三接下来得要期末考试了，目前为止已经记录了 三 个设计模式，虽说都是些平浅的知识，但十三还是要做个回顾，不是说只为了追求快而把学习过程过一遍，犹如囫囵吞枣。当然了，学好用好不只是一味埋头苦学，还需要大量的编码实践，共勉。</p><p>&emsp;&emsp;相信大家都看过哆啦A梦吧，它的口袋里似乎有着许多好玩有趣的道具，这不，它知道十三经常对着电脑，并且也知道十三喜欢吃水果可又穷得吃土，就送给了十三 一 台万能水果生产机器，可厉害了，按下按钮选择想要的水果便会自动生产出来，简直就是福音啊！<br><br></p><h2 id="神秘的万能水果生产机"><a href="#神秘的万能水果生产机" class="headerlink" title="神秘的万能水果生产机"></a>神秘的万能水果生产机</h2><p>&emsp;&emsp;十三要想吃到可口的水果也没有那么简单，这个生产机你得需要给它下达指令才能开始生产工作，十三来到了指令输入台看了示例，发现可以使用 Java 语言来写指令(惊了，哈哈），这可难不倒十三，不出一会儿功夫就写好了指令 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banana</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"生产香蕉..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"生产苹果..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;十三编好了两种生产水果的指令后，最后再来给启动按钮写了个指令，如下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span>  </span>&#123;</span><br><span class="line">        <span class="comment">// 开始生产水果</span></span><br><span class="line">        Apple apple = <span class="keyword">new</span> Apple();</span><br><span class="line">        apple.get();</span><br><span class="line">        Banana banana = <span class="keyword">new</span> Banana();</span><br><span class="line">        banana.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;十三完成所有指令后，迫不及待地按下生产机上的按钮，只听生产机发出一阵轻微的转动声响，然后就像烤面包机完成工作后发出“-叮-”的一声，接着便看到生产机吐出了水果，正是我们想要的苹果和香蕉，十三高兴地叫了出来并吃起了水果来，吃着吃着，十三心想，我是否可以再对刚才的指令进行一下优化，看看是否可以把程序耦合度降低，想了一会儿，突然十三灵光一闪，“有了，我可以考虑通过多态来做”，于是十三重新修改了指令：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Banana</span> <span class="keyword">implements</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"生产香蕉..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> <span class="keyword">implements</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"生产苹果..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;增加了一个接口 Fruit ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span>  </span>&#123;</span><br><span class="line">        <span class="comment">// 使用多态来实例化</span></span><br><span class="line">        Fruit apple = <span class="keyword">new</span> Apple();</span><br><span class="line">        Fruit banana = <span class="keyword">new</span> Banana();</span><br><span class="line">        apple.get();</span><br><span class="line">        banana.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;按下按钮后，生产机同样也能生产出水果，“相比于第一次的写法，程序耦合度降低了不少。”，十三心想，但是如果我还想生产其他些水果，比如火龙果、葡萄等，这些都是很容易变化的地方，应该要考虑这个生产过程。通过一番查阅，十三找到了简单工厂模式可以解决这个问题。<br><br></p><h2 id="简单工厂模式"><a href="#简单工厂模式" class="headerlink" title="简单工厂模式"></a>简单工厂模式</h2><p>&emsp;&emsp;十三看到资料上是这样介绍简单工厂模式的：简单工厂模式属于类的创建型模式，又叫做静态工厂方法模式。通过专门定义一个类来负责创建其他类的实例，被创建的实例通常都具有共同的父类。</p><ul><li><p>工厂模式中的角色和职责 ： </p><p>  工厂(Creator) : 简单工厂模式的核心，它负责实现创建所有实例的内部逻辑。工厂类可以被外界直接调用，创建所需的产品对象。</p><p>  抽象(Product) : 简单工厂模式所创建的所有对象的父类，它负责描述所有实例所共有的公共接口。</p><p>  具体产品(Concrete Product) ：简单工厂模式所创建的具体实例对象。</p></li></ul><p>&emsp;&emsp;那么怎么对我们的水果生产机上运用呢？别急，看码 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FruitFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get 方法，获得所有产品对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Fruit <span class="title">getFruit</span><span class="params">(String type)</span> <span class="keyword">throws</span> InstantiationException, </span></span><br><span class="line"><span class="function"> 5IllegalAccessException </span>&#123;</span><br><span class="line">        <span class="comment">// 判断水果种类，这里忽略大小写</span></span><br><span class="line">        <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">"apple"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Apple.class.newInstance();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">"banana"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Banana.class.newInstance();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"请添加该水果属性以便生产..."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里，我们就创建了个工厂类负责生产水果，只要我们选择并输入想要的水果，工厂类便会生产具体的水果产品，然后把生产好的水果产品返回给我们。当然，我们想要的水果必须得有样本属性在我们的水果生产机里，否则将生产不出来，这个时候，我们就得往生产机添加样本属性。假如添加梨，我们就得创建个类并实现接口，如下 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pear</span> <span class="keyword">implements</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">get</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"生产梨..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样，我们就可以修改 main 方法里的代码了 ：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InstantiationException, </span></span><br><span class="line"><span class="function">    IllegalAccessException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Fruit apple = FruitFactory.getFruit(<span class="string">"Apple"</span>);</span><br><span class="line">        Fruit banana = FruitFactory.getFruit(<span class="string">"Banana"</span>);</span><br><span class="line">        Fruit pear = FruitFactory.getFruit(<span class="string">"Pear"</span>);</span><br><span class="line">        apple.get();</span><br><span class="line">        banana.get();</span><br><span class="line">        pear.get();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这样，我们的水果生产机便是可以快速生产出我们想要的水果，哈哈…好了，本篇简单工厂模式的学习就到这里了，建议大家也多吃点水果，有益健康哦！<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，还有几天就放假了，果然学生还是最轻松的职业。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;div align=&quot;center&quot;&gt;&lt;img src=&quot;https://ws1.sinaimg.cn/large/0072Lfvtly1fvckak8dvkj30b40b4jrn.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="简单工厂模式" scheme="http://Binshao.site/tags/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之策略模式</title>
    <link href="http://Binshao.site/2018/07/06/Strategy/"/>
    <id>http://Binshao.site/2018/07/06/Strategy/</id>
    <published>2018-07-06T06:09:56.000Z</published>
    <updated>2018-09-17T07:19:35.090Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，今天学院要拍毕业证照片，紧接着明年就要毕业了，滴答滴答，时间就这样悄悄地过去了…</p></blockquote><p>&emsp;&emsp;这是设计模式学习的第二篇学习记录，或许涉及知识层面不深，但十三始终认为好记性不如烂笔头，进阶高深知识也得要有扎实的基础，废话就不多说了，咱们开始今天的学习。</p><a id="more"></a><p>&emsp;&emsp;还记得前段时间各大电商平台的 618 年中大促活动吗？各种优惠返利活动，满 200 减 100，满 300 减 150 等等，让人看了眼花缭乱，控制不住自己分分钟想剁手有没有！那么上面这些优惠活动用代码该怎么实现呢？十三想都没想，直接对着键盘就是一顿狂敲，噼里啪啦，不出一会儿，十三就写好了：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &gt;= <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> price - <span class="number">100</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (price &gt;= <span class="number">300</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> price - <span class="number">150</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;上面的代码非常简单，也能得到我们想要的结果，可是大家想过没有，如果这时还有其他打折优惠，那按照我们这样来写代码，那岂不是要写非常多的 if else 语句，要知道电商平台是可能经常性的更改打折额度和返利额度的，这样不得写死人，不仅代码不美观而且不利于维护，那该怎么办呢？这时十三熟练地打开 Google，面向搜索编程大法好，一番搜索下来发现，这个问题可以通过策略模式来解决。<br><br></p><h2 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h2><p>&emsp;&emsp;那么问题来了，什么是策略模式呢？</p><ul><li>策略模式（Strategy）：它定义了算法家族，分别封装起来，让它们之间可以互相替换，即使算法发生了变化，使用算法的客户也不会受到影响。</li></ul><p>&emsp;&emsp;事实上，无论是哪家电商平台的打折又或是返利活动，其实都是一些算法，这些算法本身也只是商家为了赚钱的一种策略，算法可能随时替换变化，而我们可以用策略模式把这些变化给封装起来，别急，让我们先看下策略模式有哪些角色及对应职责：</p><ul><li><p>策略模式的角色和职责：<br>  Strategy：策略抽象.</p><p>  ConcreteStrategy：各种策略的具体实现.</p><p>  Context：策略的外部封装类，或者说策略的容器类，根据不同的策略执行不同的行为.<br>  策略由外部环境来决定的.</p></li></ul><p>&emsp;&emsp;那么接下来我们就来看看怎么用策略模式来改写我们上面的例子，首先我们先编写 Strategy 这个角色：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">(<span class="keyword">double</span> price)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里我们写好了 Straategy 这个角色，它的职责便是定义所有支持的算法的公共接口，接着便是 ConcreteStrategy 这个角色，如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyA</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &gt;= <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> price - <span class="number">100</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StrategyB</span> <span class="keyword">implements</span> <span class="title">Strategy</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (price &gt;= <span class="number">300</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> price - <span class="number">150</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;可以看到我们写了两个 ConcreteStrategy，它封装了具体的算法或行为，而它是继承自 Strategy，也就是我们所说的打折优惠活动，最后来看下最后一个角色 Context：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Context</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;</span><br><span class="line">    <span class="comment">// 初始化时传入具体的策略对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Context</span><span class="params">(Strategy strategy)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 根据具体的策略对象，调用其算法的方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">cost</span><span class="params">(<span class="keyword">double</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.strategy.cost(price);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;Context 它维护了一个对 Strategy 对象的引用，而我们的 Main 方法，也就是客户端主要也是和它打交道，那么就来对它做下测试：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 假设购物所花费为 200 元</span></span><br><span class="line">        <span class="keyword">double</span> price = <span class="number">200</span>;</span><br><span class="line"><span class="comment">//        Context context = new Context(new StrategyA());</span></span><br><span class="line">        Context context = <span class="keyword">new</span> Context(<span class="keyword">new</span> StrategyB());</span><br><span class="line">        <span class="keyword">double</span> newPrice = context.cost(price);</span><br><span class="line">        System.out.println(<span class="string">"实际消费 : "</span> + newPrice);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;最后，通过运行我们也能得到正确的结果，由于实例化不同的策略，所以在调用 context.cost()方法时，所获得的结果也是不尽相同的，到这里我们的这个小例子也就完成了。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;回过头来，我们来总结下策略模式，策略模式是一种定义一系列算法的方法，我们知道其实所有算法完成的都是相同的工作，也就是为了给消费者打折优惠，只是不同的算法有不同的实现，而我们可以以相同的方式调用所有的算法，减少各种算法之间的耦合，我们把具体的算法实现封装了起来，这样也就避免了重复编写条件语句。最后，来张策略模式的结构图：</p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvck9w8mlpj30z50gomzh.jpg" alt="策略模式 UML 图"></div></p><p>&emsp;&emsp;好了，关于策略模式的学习记录就到了这里，一会儿十三还得去拍毕业证照片，不多说了，下次见。<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，今天学院要拍毕业证照片，紧接着明年就要毕业了，滴答滴答，时间就这样悄悄地过去了…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&amp;emsp;&amp;emsp;这是设计模式学习的第二篇学习记录，或许涉及知识层面不深，但十三始终认为好记性不如烂笔头，进阶高深知识也得要有扎实的基础，废话就不多说了，咱们开始今天的学习。&lt;/p&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="策略模式" scheme="http://Binshao.site/tags/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>设计模式之备忘录模式</title>
    <link href="http://Binshao.site/2018/07/04/Memento/"/>
    <id>http://Binshao.site/2018/07/04/Memento/</id>
    <published>2018-07-04T06:09:22.000Z</published>
    <updated>2018-09-17T07:14:48.864Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。今天广州的天气怕是要把我融化了，撑着伞走去实验室的路上，衣服都出汗湿透……</p></blockquote><a id="more"></a><p><div align="center"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=165184&auto=1&height=66"></iframe></div></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&emsp;&emsp;昨天嚷嚷着要学点理财知识，今天又撸代码了，风格转变真快…嘿嘿，这不还是撸代码来的痛快，偶尔换下口味嘛，读书、健身、写作一个都不落下，德智体全面发展，废话就不多说了。平常我们在学习或者看博客文章的时候，多多少少都会接触到源码方面，往往看源码看的却是一头雾水，源码不仅多且各种封装，以及设计模式的使用，新手看的是一个头两个大，比如我就是…刚好，最近也在学习设计模式，借此机会也来记录下，都是些平浅的知识，望各位不吝赐教。<br><br></p><h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><p>&emsp;&emsp;相信大家可能都有遇到这种情况，有时候我们在编辑 Word 文档或者在 PS 里修图的时候，应用突然奔溃，当我们再次打开的时候，它便提示我们是否进行恢复数据，那么它是怎么实现的呢，我没想过…假设现在我们有一个 Person 类，分别有姓名，性别，年龄。那么我们给它赋值后，假如我还想修改，那么该怎么做呢？我们就快速写一遍。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">     <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"> </span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, String sex, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name:"</span> + name + <span class="string">",sex:"</span> + sex + <span class="string">",age:"</span> + age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;非常简单，接下来我们继续看 main 方法的代码:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">mainClass</span> </span>&#123;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person per = <span class="keyword">new</span> Person(<span class="string">"Binshao"</span>, <span class="string">"Man"</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 进行备份</span></span><br><span class="line">        Person backUp = <span class="keyword">new</span> Person();</span><br><span class="line">        backUp.setName(per.getName());</span><br><span class="line">        backUp.setSex(per.getSex());</span><br><span class="line">        backUp.setAge(per.getAge());</span><br><span class="line"></span><br><span class="line">        per.display();</span><br><span class="line">        <span class="comment">// 修改</span></span><br><span class="line">        per.setAge(<span class="number">23</span>);</span><br><span class="line">        per.display();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 恢复</span></span><br><span class="line">        per.setName(backUp.getName());</span><br><span class="line">        per.setSex(backUp.getSex());</span><br><span class="line">        per.setAge(backUp.getAge());</span><br><span class="line"></span><br><span class="line">        per.display();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;通过上面简单的代码我们就实现了恢复数据属性的操作，但是不知道大家发现没有，这样一来，在 main 方法中进行了太多的操作，又是赋值又是修改的，过于繁杂且不符合单一职责原则，那怎么办呢？这时候，备忘录模式就登场了。<br><br></p><h2 id="备忘录模式"><a href="#备忘录模式" class="headerlink" title="备忘录模式"></a>备忘录模式</h2><p>&emsp;&emsp;如果一个对象需要保存状态并可通过 undo 或 rollback 等操作恢复到以前的状态时，可以使用备忘录模式。其名所示，可以进行恢复回滚数据的操作。</p><ul><li>备忘录(Memento) : 在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可以对该对象恢复到原先保存的状态。</li></ul><ul><li><p>备忘录的角色和职责 :<br>  Originator(原生者)：需要被保存状态以便恢复的那个对象.</p><p>  Memento(备忘录)：该对象由 Originator 创建，主要用来保存 Originator 的内部状态.</p><p>  Caretaker(管理者)：负责在适当的时间保存/恢复 Originator 对象的状态.</p></li></ul><p>&emsp;&emsp;说了这么多，我们来看看上面那个例子用代码怎么实现。</p><p>&emsp;&emsp;首先是 Person 类的代码如下:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, String sex, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"name:"</span> + name + <span class="string">",sex:"</span> + sex + <span class="string">",age:"</span> + age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个备份</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">createMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Memento(name, sex, age);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 恢复备份，还原</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = memento.getName();</span><br><span class="line">        <span class="keyword">this</span>.sex = memento.getSex();</span><br><span class="line">        <span class="keyword">this</span>.age = memento.getAge();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;可以看到这里多了两个方法，也就是创建备忘录方法和恢复备份这两个方法，我们的 Person 类便是对应角色里的 Originator，而 Memento 备忘录对象则是要由 Originator 来创建，然后我们创建备忘录对象并把要保存的数据导入并实例化到 Memento 对象里去，这也就是我们在 Person 类里面创建的 createMemento 方法。</p><p>&emsp;&emsp;那么这个 Memento 类又是长的什么样子呢？别急，接着往下面看 :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Memento</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String sex;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Memento</span><span class="params">(String name, String sex, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.sex = sex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;猛地一拍大腿，这怎么和 Person 类的代码差不了多少，没错，因为 Memento 类保存的便是 Originator 的内部状态，也就是保存的是我们的 Person 类的内部状态，所以当然差不了哪里去。</p><p>&emsp;&emsp;那么到这里，就还剩下最后一个 Caretaker，来，看码 :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Caretaker</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Memento memento;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Memento <span class="title">getMemento</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMemento</span><span class="params">(Memento memento)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memento = memento;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;这里面便是对 Memento 引用，代码非常简单。接下来，我们在 main 方法里看看使用？睁大眼睛，骚年 :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainClass1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Person per = <span class="keyword">new</span> Person(<span class="string">"Binshao"</span>, <span class="string">"Man"</span>, <span class="number">20</span>);</span><br><span class="line">        <span class="comment">// 创建管理者并设置备忘录</span></span><br><span class="line">        Caretaker caretaker = <span class="keyword">new</span> Caretaker();</span><br><span class="line">        caretaker.setMemento(per.createMemento());</span><br><span class="line"></span><br><span class="line">        per.display();</span><br><span class="line">        <span class="comment">// 修改年龄</span></span><br><span class="line">        per.setAge(<span class="number">23</span>);</span><br><span class="line">        per.display();</span><br><span class="line">        <span class="comment">// 调用恢复备份的方法</span></span><br><span class="line">        per.setMemento(caretaker.getMemento());</span><br><span class="line">        per.display();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;运行并看到结果，我们先修改了值然后又把值恢复了。而保存的细节我们封装在 Memento 中，要保存的细节也不会影响到客户端了，就这样，我们这个小例子就写完了，最后再来张备忘录模式的结构图 : </p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvcjgzp9vgj30lw0ajab4.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">结构图</div></p><p>&emsp;&emsp;好了，就写到这里了，祝大家有个愉快的下午茶，下午茶？不存在的……<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。今天广州的天气怕是要把我融化了，撑着伞走去实验室的路上，衣服都出汗湿透……&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="设计模式" scheme="http://Binshao.site/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="备忘录模式" scheme="http://Binshao.site/tags/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>黑苹果踩坑指南</title>
    <link href="http://Binshao.site/2018/06/25/blackApple/"/>
    <id>http://Binshao.site/2018/06/25/blackApple/</id>
    <published>2018-06-25T06:07:49.000Z</published>
    <updated>2018-09-17T06:35:54.510Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三。刚刚高考分数线发布出来了，想必也是有人欢喜有人愁，回想起来，不免心生些许感概。</p></blockquote><a id="more"></a><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvciqr1843j30zk0n9n2g.jpg" alt=""></div></p><p><div align="center" style="font-size: 13px; color: gray;">十三也想要台 Mac</div></p><h2 id="最近"><a href="#最近" class="headerlink" title="最近"></a>最近</h2><p>&emsp;&emsp;自从上星期端午假后，接下来十三一直都在忙课程设计，What，什么课程设计？iOS…十三所在专业是移动应用专业，也正因此走上 Android 不归路，当然了，既然是移动端，少不了 iOS，这不，十三最近不是正忙着课程设计上嘛。当然了，由于这些年，移动互联网热度的下降，这大大地打击同学们上课的热情（十三从来就很认真，哼哼..大雾），导致于最近不少同学在弄课程设计上都哭爹喊娘的，我也替这些同学感到些惋惜，学院配备全 Mac 一体机的机房环境，这还真是浪费了这良好的学习环境。这不是重点，重点是 Mac 实在是太好用了，我都想放弃自己这台大卡逼 Window 了，还是因为这万恶的金钱，穷啊！</p><p>&emsp;&emsp;所以既然要完成课程设计，无可奈何，只能黑苹果了。通常情况下，都是用 VMware 来跑 Mac 系统，具体安装的流程大家网上搜索下就能找到了，比较坑的是网上提供的系统资源要么跑不起来，要么就是系统版本和 VMware 解锁黑苹果补丁不匹配，除了这点比较坑之外，其他的都可以正常按流程走下去。十三至少花了一天半的时间下镜像和 Xcode 安装包，至少十几个 G，加上学院宿舍里渣渣网速，醉了醉了…<br><br></p><h2 id="黑苹果"><a href="#黑苹果" class="headerlink" title="黑苹果"></a>黑苹果</h2><p>&emsp;&emsp;当然了，十三今天已经把课程设计完成了，十三就把要用到的资源共享下，顺便来说下黑苹果要注意的地方。</p><ul><li><p>首先 VMware 默认是没有安装苹果镜像选项的，所以需要打补丁，而补丁又得要和对应 VMware 版本搭配才能使用，否则无效。</p></li><li><p>其次，当我们完成上面第一步的时候，基本也就能进入苹果系统了，接下来安装 Xcode，要注意 Xcode 版本是对我们安装 Mac OS 版本是有要求的，低版本的 OS X 是不支持高版本的 Xcode，这点大家务必注意下，毕竟 XCode 下载动辄几个 G，对应关系给个例图。</p></li></ul><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvcivf1cpdj30qa06omy0.jpg" alt=""></div></p><p><div align="center" style="font-size: 13px; color: gray;">对应版本关系图</div></p><p>&emsp;&emsp;走到了这一步，基本上我们 iOS 的开发环境就已经是搭建起来了，别急，我们还可以再优化一下，毕竟虚拟机下跑个系统，机器硬盘下那是卡出了翔……</p><ol><li><p>首先，刚进入桌面就发现一堆的通知显示，这些我们都可以在<code>系统偏好设置</code>中进入<code>扩展</code>选项中，把不需要的通知组件都取消勾选掉，不仅清爽还能流畅不少。</p></li><li><p>其次，OS X 中的菜单和 Dock 都采用了透明效果，好看是好看，可 TM 吃性能，在<code>系统偏好设置</code>中进入<code>辅助功能</code>选项中，然后我们找到<code>减少透明度</code>选项并把它勾选上。</p></li><li><p>最后，来个大杀器——<code>beamoff</code>，安装它可以提升 OS X 在 VMware 的性能，我们可以把它设置为开机自动运行。</p></li></ol><p>&emsp;&emsp;好了，经过上面几步的优化，都可以流畅使用，偶尔会些许卡顿，哎哟，真是累死我了…好了，我把一些用到的资源都共享到百度云盘上，大家去阅读原文点击就能跳转到资源页面了。<br><br></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&emsp;&emsp;这几天在做课程设计上，发现写代码还是比较行云流水的，主要还是课上 OC 基础语法掌握的不错，我想，这也可以涉及到广度的选择上吧，记得主席任玉刚在博客曾说道他在校期间深入学习 Android 的同时也去了解其他，如 Html，Java 等等，这不也算是扩大自己的知识面吗？这样技术的广度和深度也就有了，而 iOS 作为移动开发，玩 Android 的我们也是可以去看看的，没有坏处。学习之路漫长，还有很多东西要学，大家一起加油，我也争取早一天拥有我第一台的 Mac，无它，好用。溜了溜了…<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三。刚刚高考分数线发布出来了，想必也是有人欢喜有人愁，回想起来，不免心生些许感概。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Mac" scheme="http://Binshao.site/categories/Mac/"/>
    
    
      <category term="黑苹果" scheme="http://Binshao.site/tags/%E9%BB%91%E8%8B%B9%E6%9E%9C/"/>
    
  </entry>
  
  <entry>
    <title>推荐一些读过的技术书籍</title>
    <link href="http://Binshao.site/2018/06/17/readBook/"/>
    <id>http://Binshao.site/2018/06/17/readBook/</id>
    <published>2018-06-17T04:44:48.000Z</published>
    <updated>2018-09-17T05:31:38.347Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Hi，我是十三，端午三天小长假，不知道大家都去哪里浪？</p></blockquote><a id="more"></a><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvcgt2rm09j30zk0npjwb.jpg" alt=""></div></p><p><div align="center" style="font-size: 13px; color: gray;">photo by Wistaria from Polayoutu</div></p><h2 id="杂七杂八……"><a href="#杂七杂八……" class="headerlink" title="杂七杂八……"></a>杂七杂八……</h2><p>&emsp;&emsp;各位，又是一段时间没来这里写东西了，最近朋友圈可都被世界杯刷屏了，吐槽下，平时看起来不关心的同学，一下子仿佛成了资深球迷，点评的头头是道，就像是要蹭个热点刷个存在感似，发现人都是害怕孤独的，然而一切都被机智的我看穿了（丫的，挺能装！），哈哈！</p><p>&emsp;&emsp;端午节大家去浪的同时，记得给家里人打个电话，有时候吧，亲情阿，懂得自然就懂，十三从来就很珍惜当下，或许我是性情中人？可能真的哪一天才发现失去了最美好的，那时候才真的是后悔莫及。</p><p>&emsp;&emsp;好了，自从最近看完了《Java编程思想》后，我萌发了从头看看自己之前学习的 Android 代码和笔记的念头，说干就干，近几天，由浅入深，我都在回过头来看看之前做的笔记和代码，当然，这比刚入门那会儿来的要轻松，我知道这是基础打得牢固的重要性，一直都要注重基础。滴答滴答，时间就这么过去了，也算是对之前学过的东西做了次回顾，查缺补漏，市面上讲叫做建立自己的知识体系，而一点一点的知识基础，汇总成一个个知识面，由点到面逐渐形成体系。就像书的目录编排，它是有系统性的，由浅入深的。当然了，学的越多不懂得也就越多，这里，大家一起加油！</p><p>&emsp;&emsp;最后就是，这些天刚好各大电商平台都在搞活动，京东和当当都在促销，这里推荐一些 Android 书籍，这些书我都买了并且认为不错。书籍作者都是一些我们熟知的大神，有郭神，主席任玉刚，刘望舒，医生，当然了还有鸿洋大神的玩安卓网站等等，就不废话了。</p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvcgtx1c7bj305k074jrk.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">《第一行代码 第二版》 郭霖著</div></p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvch56zgm6j305k077glu.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">《Android群英传》 徐宜生著</div></p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvch5jn13tj305k07ajrh.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Android开发艺术探索》 任玉刚著</div></p><p><div align="center"><img src="https://ws1.sinaimg.cn/large/0072Lfvtly1fvch1f11j3j305k07dt8x.jpg" alt=""></div></p><p><div align="center" style="font-size: 11px; color: gray;">Android进阶之光》 刘望舒著</div></p><p>&emsp;&emsp;当然了，除了技术书籍，其他的书籍我也喜欢看，以后再推荐吧，也欢迎大家推荐一些好书给我，端午节快乐，大家！<br><br><br><br></p><hr><p><div align="center"><img src="http://wx2.sinaimg.cn/mw690/0060lm7Tly1fvbqgfo4lwj303l03lmx8.jpg" alt="扫一扫点击关注"><br>十三的记事本<br>欢迎大家关注我的公众号</div></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Hi，我是十三，端午三天小长假，不知道大家都去哪里浪？&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="书籍" scheme="http://Binshao.site/categories/%E4%B9%A6%E7%B1%8D/"/>
    
    
      <category term="Android 书籍" scheme="http://Binshao.site/tags/Android-%E4%B9%A6%E7%B1%8D/"/>
    
  </entry>
  
</feed>
